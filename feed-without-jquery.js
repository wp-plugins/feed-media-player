/**
 * almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

//     Underscore.js 1.3.3
//     (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore is freely distributable under the MIT license.
//     Portions of Underscore are inspired or borrowed from Prototype,
//     Oliver Steele's Functional, and John Resig's Micro-Templating.
//     For all details and documentation:
//     http://documentcloud.github.com/underscore

/*
CryptoJS v3.0.2
code.google.com/p/crypto-js
(c) 2009-2012 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/

/*
 * Copyright 2008 Netflix, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*
 *  Events mixin from Backbone 
 *
 *  Backbone.js 1.0.0
 *
 *  (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
 *  Backbone may be freely distributed under the MIT license.
 *  For all details and documentation:
 *  http:*backbonejs.org
 *
 *  A module that can be mixed in to *any object* in order to provide it with
 *  custom events. You may bind with `on` or remove with `off` callback functions
 *  to an event; trigger`-ing an event fires all callbacks in succession.
 *
 *  var object = {};
 *  _.extend(object, Backbone.Events);
 *  object.on('expand', function(){ alert('expanded'); });
 *  object.trigger('expand');
 */

/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */

/** @license
 *
 * SoundManager 2: JavaScript Sound for the Web
 * ----------------------------------------------
 * http://schillmania.com/projects/soundmanager2/
 *
 * Copyright (c) 2007, Scott Schiller. All rights reserved.
 * Code provided under the BSD License:
 * http://schillmania.com/projects/soundmanager2/license.txt
 *
 * V2.97a.20131201
 */

/*! A Feed.fm joint: github.com/fuzz-radio/Javascript-SDK */

window.SM2_DEFER=!0;var requirejs,require,define;(function(e){function c(e,t){return f.call(e,t)}function h(e,t){var n,r,i,s,o,a,f,l,c,h,p=t&&t.split("/"),d=u.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(l=0;l<e.length;l+=1){h=e[l];if(h===".")e.splice(l,1),l-=1;else if(h===".."){if(l===1&&(e[2]===".."||e[0]===".."))break;l>0&&(e.splice(l-1,2),l-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(l=n.length;l>0;l-=1){r=n.slice(0,l).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=l;break}}}if(s)break;!a&&v&&v[r]&&(a=v[r],f=l)}!s&&a&&(s=a,o=f),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function p(t,r){return function(){return n.apply(e,l.call(arguments,0).concat([t,r]))}}function d(e){return function(t){return h(t,e)}}function v(e){return function(t){s[e]=t}}function m(n){if(c(o,n)){var r=o[n];delete o[n],a[n]=!0,t.apply(e,r)}if(!c(s,n)&&!c(a,n))throw new Error("No "+n);return s[n]}function g(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function y(e){return function(){return u&&u.config&&u.config[e]||{}}}var t,n,r,i,s={},o={},u={},a={},f=Object.prototype.hasOwnProperty,l=[].slice;r=function(e,t){var n,r=g(e),i=r[0];return e=r[1],i&&(i=h(i,t),n=m(i)),i?n&&n.normalize?e=n.normalize(e,d(t)):e=h(e,t):(e=h(e,t),r=g(e),i=r[0],e=r[1],i&&(n=m(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},i={require:function(e){return p(e)},exports:function(e){var t=s[e];return typeof t!="undefined"?t:s[e]={}},module:function(e){return{id:e,uri:"",exports:s[e],config:y(e)}}},t=function(t,n,u,f){var l,h,d,g,y,b=[],w;f=f||t;if(typeof u=="function"){n=!n.length&&u.length?["require","exports","module"]:n;for(y=0;y<n.length;y+=1){g=r(n[y],f),h=g.f;if(h==="require")b[y]=i.require(t);else if(h==="exports")b[y]=i.exports(t),w=!0;else if(h==="module")l=b[y]=i.module(t);else if(c(s,h)||c(o,h)||c(a,h))b[y]=m(h);else{if(!g.p)throw new Error(t+" missing "+h);g.p.load(g.n,p(f,!0),v(h),{}),b[y]=s[h]}}d=u.apply(s[t],b);if(t)if(l&&l.exports!==e&&l.exports!==s[t])s[t]=l.exports;else if(d!==e||!w)s[t]=d}else t&&(s[t]=u)},requirejs=require=n=function(s,o,a,f,l){return typeof s=="string"?i[s]?i[s](o):m(r(s,o).f):(s.splice||(u=s,o.splice?(s=o,o=a,a=null):s=e),o=o||function(){},typeof a=="function"&&(a=f,f=l),f?t(e,s,o,a):setTimeout(function(){t(e,s,o,a)},4),n)},n.config=function(e){return u=e,u.deps&&n(u.deps,u.callback),n},requirejs._defined=s,define=function(e,t,n){t.splice||(n=t,t=[]),!c(s,e)&&!c(o,e)&&(o[e]=[e,t,n])},define.amd={jQuery:!0}})(),define("almond",function(){}),function(){function C(e,t,n){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e._chain&&(e=e._wrapped),t._chain&&(t=t._wrapped);if(e.isEqual&&S.isFunction(e.isEqual))return e.isEqual(t);if(t.isEqual&&S.isFunction(t.isEqual))return t.isEqual(e);var r=a.call(e);if(r!=a.call(t))return!1;switch(r){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var i=n.length;while(i--)if(n[i]==e)return!0;n.push(e);var s=0,o=!0;if(r=="[object Array]"){s=e.length,o=s==t.length;if(o)while(s--)if(!(o=s in e==s in t&&C(e[s],t[s],n)))break}else{if("constructor"in e!="constructor"in t||e.constructor!=t.constructor)return!1;for(var u in e)if(S.has(e,u)){s++;if(!(o=S.has(t,u)&&C(e[u],t[u],n)))break}if(o){for(u in t)if(S.has(t,u)&&!(s--))break;o=!s}}return n.pop(),o}var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.slice,u=r.unshift,a=i.toString,f=i.hasOwnProperty,l=r.forEach,c=r.map,h=r.reduce,p=r.reduceRight,d=r.filter,v=r.every,m=r.some,g=r.indexOf,y=r.lastIndexOf,b=Array.isArray,w=Object.keys,E=s.bind,S=function(e){return new P(e)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=S),exports._=S):e._=S,S.VERSION="1.3.3";var x=S.each=S.forEach=function(e,t,r){if(e==null)return;if(l&&e.forEach===l)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(i in e&&t.call(r,e[i],i,e)===n)return}else for(var o in e)if(S.has(e,o)&&t.call(r,e[o],o,e)===n)return};S.map=S.collect=function(e,t,n){var r=[];return e==null?r:c&&e.map===c?e.map(t,n):(x(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),e.length===+e.length&&(r.length=e.length),r)},S.reduce=S.foldl=S.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(h&&e.reduce===h)return r&&(t=S.bind(t,r)),i?e.reduce(t,n):e.reduce(t);x(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},S.reduceRight=S.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduceRight===p)return r&&(t=S.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=S.toArray(e).reverse();return r&&!i&&(t=S.bind(t,r)),i?S.reduce(s,t,n,r):S.reduce(s,t)},S.find=S.detect=function(e,t,n){var r;return T(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},S.filter=S.select=function(e,t,n){var r=[];return e==null?r:d&&e.filter===d?e.filter(t,n):(x(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},S.reject=function(e,t,n){var r=[];return e==null?r:(x(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r)},S.every=S.all=function(e,t,r){var i=!0;return e==null?i:v&&e.every===v?e.every(t,r):(x(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var T=S.some=S.any=function(e,t,r){t||(t=S.identity);var i=!1;return e==null?i:m&&e.some===m?e.some(t,r):(x(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};S.include=S.contains=function(e,t){var n=!1;return e==null?n:g&&e.indexOf===g?e.indexOf(t)!=-1:(n=T(e,function(e){return e===t}),n)},S.invoke=function(e,t){var n=o.call(arguments,2);return S.map(e,function(e){return(S.isFunction(t)?t||e:e[t]).apply(e,n)})},S.pluck=function(e,t){return S.map(e,function(e){return e[t]})},S.max=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0])return Math.max.apply(Math,e);if(!t&&S.isEmpty(e))return-Infinity;var r={computed:-Infinity};return x(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},S.min=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0])return Math.min.apply(Math,e);if(!t&&S.isEmpty(e))return Infinity;var r={computed:Infinity};return x(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},S.shuffle=function(e){var t=[],n;return x(e,function(e,r,i){n=Math.floor(Math.random()*(r+1)),t[r]=t[n],t[n]=e}),t},S.sortBy=function(e,t,n){var r=S.isFunction(t)?t:function(e){return e[t]};return S.pluck(S.map(e,function(e,t,i){return{value:e,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;return n===void 0?1:r===void 0?-1:n<r?-1:n>r?1:0}),"value")},S.groupBy=function(e,t){var n={},r=S.isFunction(t)?t:function(e){return e[t]};return x(e,function(e,t){var i=r(e,t);(n[i]||(n[i]=[])).push(e)}),n},S.sortedIndex=function(e,t,n){n||(n=S.identity);var r=0,i=e.length;while(r<i){var s=r+i>>1;n(e[s])<n(t)?r=s+1:i=s}return r},S.toArray=function(e){return e?S.isArray(e)?o.call(e):S.isArguments(e)?o.call(e):e.toArray&&S.isFunction(e.toArray)?e.toArray():S.values(e):[]},S.size=function(e){return S.isArray(e)?e.length:S.keys(e).length},S.first=S.head=S.take=function(e,t,n){return t!=null&&!n?o.call(e,0,t):e[0]},S.initial=function(e,t,n){return o.call(e,0,e.length-(t==null||n?1:t))},S.last=function(e,t,n){return t!=null&&!n?o.call(e,Math.max(e.length-t,0)):e[e.length-1]},S.rest=S.tail=function(e,t,n){return o.call(e,t==null||n?1:t)},S.compact=function(e){return S.filter(e,function(e){return!!e})},S.flatten=function(e,t){return S.reduce(e,function(e,n){return S.isArray(n)?e.concat(t?n:S.flatten(n)):(e[e.length]=n,e)},[])},S.without=function(e){return S.difference(e,o.call(arguments,1))},S.uniq=S.unique=function(e,t,n){var r=n?S.map(e,n):e,i=[];return e.length<3&&(t=!0),S.reduce(r,function(n,r,s){if(t?S.last(n)!==r||!n.length:!S.include(n,r))n.push(r),i.push(e[s]);return n},[]),i},S.union=function(){return S.uniq(S.flatten(arguments,!0))},S.intersection=S.intersect=function(e){var t=o.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})},S.difference=function(e){var t=S.flatten(o.call(arguments,1),!0);return S.filter(e,function(e){return!S.include(t,e)})},S.zip=function(){var e=o.call(arguments),t=S.max(S.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=S.pluck(e,""+r);return n},S.indexOf=function(e,t,n){if(e==null)return-1;var r,i;if(n)return r=S.sortedIndex(e,t),e[r]===t?r:-1;if(g&&e.indexOf===g)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(r in e&&e[r]===t)return r;return-1},S.lastIndexOf=function(e,t){if(e==null)return-1;if(y&&e.lastIndexOf===y)return e.lastIndexOf(t);var n=e.length;while(n--)if(n in e&&e[n]===t)return n;return-1},S.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var N=function(){};S.bind=function(t,n){var r,i;if(t.bind===E&&E)return E.apply(t,o.call(arguments,1));if(!S.isFunction(t))throw new TypeError;return i=o.call(arguments,2),r=function(){if(this instanceof r){N.prototype=t.prototype;var e=new N,s=t.apply(e,i.concat(o.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(o.call(arguments)))}},S.bindAll=function(e){var t=o.call(arguments,1);return t.length==0&&(t=S.functions(e)),x(t,function(t){e[t]=S.bind(e[t],e)}),e},S.memoize=function(e,t){var n={};return t||(t=S.identity),function(){var r=t.apply(this,arguments);return S.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},S.delay=function(e,t){var n=o.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},S.defer=function(e){return S.delay.apply(S,[e,1].concat(o.call(arguments,1)))},S.throttle=function(e,t){var n,r,i,s,o,u,a=S.debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;var f=function(){i=null,o&&e.apply(n,r),a()};return i||(i=setTimeout(f,t)),s?o=!0:u=e.apply(n,r),a(),s=!0,u}},S.debounce=function(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,n||e.apply(i,s)};n&&!r&&e.apply(i,s),clearTimeout(r),r=setTimeout(o,t)}},S.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments))}},S.wrap=function(e,t){return function(){var n=[e].concat(o.call(arguments,0));return t.apply(this,n)}},S.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},S.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},S.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)S.has(e,n)&&(t[t.length]=n);return t},S.values=function(e){return S.map(e,S.identity)},S.functions=S.methods=function(e){var t=[];for(var n in e)S.isFunction(e[n])&&t.push(n);return t.sort()},S.extend=function(e){return x(o.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},S.pick=function(e){var t={};return x(S.flatten(o.call(arguments,1)),function(n){n in e&&(t[n]=e[n])}),t},S.defaults=function(e){return x(o.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e},S.tap=function(e,t){return t(e),e},S.isEqual=function(e,t){return C(e,t,[])},S.isEmpty=function(e){if(e==null)return!0;if(S.isArray(e)||S.isString(e))return e.length===0;for(var t in e)if(S.has(e,t))return!1;return!0},S.isElement=function(e){return!!e&&e.nodeType==1},S.isArray=b||function(e){return a.call(e)=="[object Array]"},S.isObject=function(e){return e===Object(e)},S.isArguments=function(e){return a.call(e)=="[object Arguments]"},S.isArguments(arguments)||(S.isArguments=function(e){return!!e&&!!S.has(e,"callee")}),S.isFunction=function(e){return a.call(e)=="[object Function]"},S.isString=function(e){return a.call(e)=="[object String]"},S.isNumber=function(e){return a.call(e)=="[object Number]"},S.isFinite=function(e){return S.isNumber(e)&&isFinite(e)},S.isNaN=function(e){return e!==e},S.isBoolean=function(e){return e===!0||e===!1||a.call(e)=="[object Boolean]"},S.isDate=function(e){return a.call(e)=="[object Date]"},S.isRegExp=function(e){return a.call(e)=="[object RegExp]"},S.isNull=function(e){return e===null},S.isUndefined=function(e){return e===void 0},S.has=function(e,t){return f.call(e,t)},S.noConflict=function(){return e._=t,this},S.identity=function(e){return e},S.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},S.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},S.result=function(e,t){if(e==null)return null;var n=e[t];return S.isFunction(n)?n.call(e):n},S.mixin=function(e){x(S.functions(e),function(t){B(t,S[t]=e[t])})};var k=0;S.uniqueId=function(e){var t=k++;return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/.^/,A={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var O in A)A[A[O]]=O;var M=/\\|'|\r|\n|\t|\u2028|\u2029/g,_=/\\(\\|'|r|n|t|u2028|u2029)/g,D=function(e){return e.replace(_,function(e,t){return A[t]})};S.template=function(e,t,n){n=S.defaults(n||{},S.templateSettings);var r="__p+='"+e.replace(M,function(e){return"\\"+A[e]}).replace(n.escape||L,function(e,t){return"'+\n_.escape("+D(t)+")+\n'"}).replace(n.interpolate||L,function(e,t){return"'+\n("+D(t)+")+\n'"}).replace(n.evaluate||L,function(e,t){return"';\n"+D(t)+"\n;__p+='"})+"';\n";n.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+r+"return __p;\n";var i=new Function(n.variable||"obj","_",r);if(t)return i(t,S);var s=function(e){return i.call(this,e,S)};return s.source="function("+(n.variable||"obj")+"){\n"+r+"}",s},S.chain=function(e){return S(e).chain()};var P=function(e){this._wrapped=e};S.prototype=P.prototype;var H=function(e,t){return t?S(e).chain():e},B=function(e,t){P.prototype[e]=function(){var e=o.call(arguments);return u.call(e,this._wrapped),H(t.apply(S,e),this._chain)}};S.mixin(S),x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];P.prototype[e]=function(){var n=this._wrapped;t.apply(n,arguments);var r=n.length;return(e=="shift"||e=="splice")&&r===0&&delete n[0],H(n,this._chain)}}),x(["concat","join","slice"],function(e){var t=r[e];P.prototype[e]=function(){return H(t.apply(this._wrapped,arguments),this._chain)}}),P.prototype.chain=function(){return this._chain=!0,this},P.prototype.value=function(){return this._wrapped}}.call(this),define("underscore",function(e){return function(){var t,n;return t||e._}}(this)),define("feed/jquery-external",[],function(){return window.jQuery});var CryptoJS=CryptoJS||function(e,t){var n={},r=n.lib={},i=r.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var n=new e;return t&&n.mixIn(t),n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.$super.extend(this)}}}(),s=r.WordArray=i.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,e=e.sigBytes;this.clamp();if(r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return s.create(n,t)}}),o=n.enc={},u=o.Hex={stringify:function(e){for(var t=e.words,e=e.sigBytes,n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-8*(r%4)&255;n.push((i>>>4).toString(16)),n.push((i&15).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return s.create(n,t/2)}},a=o.Latin1={stringify:function(e){for(var t=e.words,e=e.sigBytes,n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(e.charCodeAt(r)&255)<<24-8*(r%4);return s.create(n,t)}},f=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(a.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return a.parse(unescape(encodeURIComponent(e)))}},l=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=s.create(),this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,u=i/(4*o),u=t?e.ceil(u):e.max((u|0)-this._minBufferSize,0),t=u*o,i=e.min(4*t,i);if(t){for(var a=0;a<t;a+=o)this._doProcessBlock(r,a);a=r.splice(0,t),n.sigBytes-=i}return s.create(a,i)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=l.extend({init:function(){this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize(),this._hash},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:16,_createHelper:function(e){return function(t,n){return e.create(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return c.HMAC.create(e,n).finalize(t)}}});var c=n.algo={};return n}(Math);(function(e){var t=CryptoJS,n=t.lib,r=n.WordArray,n=n.Hasher,i=t.algo,s=[],o=[];(function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(e|0))|0}for(var r=2,i=0;64>i;)t(r)&&(8>i&&(s[i]=n(e.pow(r,.5))),o[i]=n(e.pow(r,1/3)),i++),r++})();var u=[],i=i.SHA256=n.extend({_doReset:function(){this._hash=r.create(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],a=n[3],f=n[4],l=n[5],c=n[6],h=n[7],p=0;64>p;p++){if(16>p)u[p]=e[t+p]|0;else{var d=u[p-15],v=u[p-2];u[p]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+u[p-7]+((v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10)+u[p-16]}d=h+((f<<26|f>>>6)^(f<<21|f>>>11)^(f<<7|f>>>25))+(f&l^~f&c)+o[p]+u[p],v=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&s^i&s),h=c,c=l,l=f,f=a+d|0,a=s,s=i,i=r,r=d+v|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+f|0,n[5]=n[5]+l|0,n[6]=n[6]+c|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[(r+64>>>9<<4)+15]=n,e.sigBytes=4*t.length,this._process()}});t.SHA256=n._createHelper(i),t.HmacSHA256=n._createHmacHelper(i)})(Math),function(){var e=CryptoJS,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=e.create(),"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,s=4*r;n.sigBytes>s&&(n=e.finalize(n));for(var o=this._oKey=n.clone(),u=this._iKey=n.clone(),a=o.words,f=u.words,l=0;l<r;l++)a[l]^=1549556828,f[l]^=909522486;o.sigBytes=u.sigBytes=s,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,e=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),define("CryptoJS",function(e){return function(){var t,n;return t||e.CryptoJS}}(this));var OAuth;OAuth==null&&(OAuth={}),OAuth.setProperties=function(t,n){if(t!=null&&n!=null)for(var r in n)t[r]=n[r];return t},OAuth.setProperties(OAuth,{percentEncode:function(t){if(t==null)return"";if(t instanceof Array){var n="";for(var r=0;r<t.length;++t)n!=""&&(n+="&"),n+=OAuth.percentEncode(t[r]);return n}return t=encodeURIComponent(t),t=t.replace(/\!/g,"%21"),t=t.replace(/\*/g,"%2A"),t=t.replace(/\'/g,"%27"),t=t.replace(/\(/g,"%28"),t=t.replace(/\)/g,"%29"),t},decodePercent:function(t){return t!=null&&(t=t.replace(/\+/g," ")),decodeURIComponent(t)},getParameterList:function(t){if(t==null)return[];if(typeof t!="object")return OAuth.decodeForm(t+"");if(t instanceof Array)return t;var n=[];for(var r in t)n.push([r,t[r]]);return n},getParameterMap:function(t){if(t==null)return{};if(typeof t!="object")return OAuth.getParameterMap(OAuth.decodeForm(t+""));if(t instanceof Array){var n={};for(var r=0;r<t.length;++r){var i=t[r][0];n[i]===undefined&&(n[i]=t[r][1])}return n}return t},getParameter:function(t,n){if(t instanceof Array){for(var r=0;r<t.length;++r)if(t[r][0]==n)return t[r][1];return null}return OAuth.getParameterMap(t)[n]},formEncode:function(t){var n="",r=OAuth.getParameterList(t);for(var i=0;i<r.length;++i){var s=r[i][1];s==null&&(s=""),n!=""&&(n+="&"),n+=OAuth.percentEncode(r[i][0])+"="+OAuth.percentEncode(s)}return n},decodeForm:function(t){var n=[],r=t.split("&");for(var i=0;i<r.length;++i){var s=r[i];if(s=="")continue;var o=s.indexOf("="),u,a;o<0?(u=OAuth.decodePercent(s),a=null):(u=OAuth.decodePercent(s.substring(0,o)),a=OAuth.decodePercent(s.substring(o+1))),n.push([u,a])}return n},setParameter:function(t,n,r){var i=t.parameters;if(i instanceof Array){for(var s=0;s<i.length;++s)i[s][0]==n&&(r===undefined?i.splice(s,1):(i[s][1]=r,r=undefined));r!==undefined&&i.push([n,r])}else i=OAuth.getParameterMap(i),i[n]=r,t.parameters=i},setParameters:function(t,n){var r=OAuth.getParameterList(n);for(var i=0;i<r.length;++i)OAuth.setParameter(t,r[i][0],r[i][1])},completeRequest:function(t,n){t.method==null&&(t.method="GET");var r=OAuth.getParameterMap(t.parameters);r.oauth_consumer_key==null&&OAuth.setParameter(t,"oauth_consumer_key",n.consumerKey||""),r.oauth_token==null&&n.token!=null&&OAuth.setParameter(t,"oauth_token",n.token),r.oauth_version==null&&OAuth.setParameter(t,"oauth_version","1.0"),r.oauth_timestamp==null&&OAuth.setParameter(t,"oauth_timestamp",OAuth.timestamp()),r.oauth_nonce==null&&OAuth.setParameter(t,"oauth_nonce",OAuth.nonce(6)),OAuth.SignatureMethod.sign(t,n)},setTimestampAndNonce:function(t){OAuth.setParameter(t,"oauth_timestamp",OAuth.timestamp()),OAuth.setParameter(t,"oauth_nonce",OAuth.nonce(6))},addToURL:function(t,n){newURL=t;if(n!=null){var r=OAuth.formEncode(n);if(r.length>0){var i=t.indexOf("?");i<0?newURL+="?":newURL+="&",newURL+=r}}return newURL},getAuthorizationHeader:function(t,n){var r='OAuth realm="'+OAuth.percentEncode(t)+'"',i=OAuth.getParameterList(n);for(var s=0;s<i.length;++s){var o=i[s],u=o[0];u.indexOf("oauth_")==0&&(r+=","+OAuth.percentEncode(u)+'="'+OAuth.percentEncode(o[1])+'"')}return r},correctTimestampFromSrc:function(t){t=t||"oauth_timestamp";var n=document.getElementsByTagName("script");if(n==null||!n.length)return;var r=n[n.length-1].src;if(!r)return;var i=r.indexOf("?");if(i<0)return;parameters=OAuth.getParameterMap(OAuth.decodeForm(r.substring(i+1)));var s=parameters[t];if(s==null)return;OAuth.correctTimestamp(s)},correctTimestamp:function(t){OAuth.timeCorrectionMsec=t*1e3-(new Date).getTime()},timeCorrectionMsec:0,timestamp:function(){var t=(new Date).getTime()+OAuth.timeCorrectionMsec;return Math.floor(t/1e3)},nonce:function(t){var n=OAuth.nonce.CHARS,r="";for(var i=0;i<t;++i){var s=Math.floor(Math.random()*n.length);r+=n.substring(s,s+1)}return r}}),OAuth.nonce.CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",OAuth.declareClass=function(t,n,r){var i=t[n];t[n]=r;if(r!=null&&i!=null)for(var s in i)s!="prototype"&&(r[s]=i[s]);return r},OAuth.declareClass(OAuth,"SignatureMethod",function(){}),OAuth.setProperties(OAuth.SignatureMethod.prototype,{sign:function(t){var n=OAuth.SignatureMethod.getBaseString(t),r=this.getSignature(n);return OAuth.setParameter(t,"oauth_signature",r),r},initialize:function(t,n){var r;n.accessorSecret!=null&&t.length>9&&t.substring(t.length-9)=="-Accessor"?r=n.accessorSecret:r=n.consumerSecret,this.key=OAuth.percentEncode(r)+"&"+OAuth.percentEncode(n.tokenSecret)}}),OAuth.setProperties(OAuth.SignatureMethod,{sign:function(t,n){var r=OAuth.getParameterMap(t.parameters).oauth_signature_method;if(r==null||r=="")r="HMAC-SHA1",OAuth.setParameter(t,"oauth_signature_method",r);OAuth.SignatureMethod.newMethod(r,n).sign(t)},newMethod:function(t,n){var r=OAuth.SignatureMethod.REGISTERED[t];if(r!=null){var i=new r;return i.initialize(t,n),i}var s=new Error("signature_method_rejected"),o="";for(var u in OAuth.SignatureMethod.REGISTERED)o!=""&&(o+="&"),o+=OAuth.percentEncode(u);throw s.oauth_acceptable_signature_methods=o,s},REGISTERED:{},registerMethodClass:function(t,n){for(var r=0;r<t.length;++r)OAuth.SignatureMethod.REGISTERED[t[r]]=n},makeSubclass:function(t){var n=OAuth.SignatureMethod,r=function(){n.call(this)};return r.prototype=new n,r.prototype.getSignature=t,r.prototype.constructor=r,r},getBaseString:function(t){var n=t.action,r=n.indexOf("?"),i;if(r<0)i=t.parameters;else{i=OAuth.decodeForm(n.substring(r+1));var s=OAuth.getParameterList(t.parameters);for(var o=0;o<s.length;++o)i.push(s[o])}return OAuth.percentEncode(t.method.toUpperCase())+"&"+OAuth.percentEncode(OAuth.SignatureMethod.normalizeUrl(n))+"&"+OAuth.percentEncode(OAuth.SignatureMethod.normalizeParameters(i))},normalizeUrl:function(t){var n=OAuth.SignatureMethod.parseUri(t),r=n.protocol.toLowerCase(),i=n.authority.toLowerCase(),s=r=="http"&&n.port==80||r=="https"&&n.port==443;if(s){var o=i.lastIndexOf(":");o>=0&&(i=i.substring(0,o))}var u=n.path;return u||(u="/"),r+"://"+i+u},parseUri:function(t){var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=n.parser.strict.exec(t),i={},s=14;while(s--)i[n.key[s]]=r[s]||"";return i},normalizeParameters:function(t){if(t==null)return"";var n=OAuth.getParameterList(t),r=[];for(var i=0;i<n.length;++i){var s=n[i];s[0]!="oauth_signature"&&r.push([OAuth.percentEncode(s[0])+" "+OAuth.percentEncode(s[1]),s])}r.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0});var o=[];for(var u=0;u<r.length;++u)o.push(r[u][1]);return OAuth.formEncode(o)}}),OAuth.SignatureMethod.registerMethodClass(["PLAINTEXT","PLAINTEXT-Accessor"],OAuth.SignatureMethod.makeSubclass(function(t){return this.key})),OAuth.SignatureMethod.registerMethodClass(["HMAC-SHA1","HMAC-SHA1-Accessor"],OAuth.SignatureMethod.makeSubclass(function(t){b64pad="=";var n=b64_hmac_sha1(this.key,t);return n}));try{OAuth.correctTimestampFromSrc()}catch(e){}define("OAuth",function(e){return function(){var t,n;return t||e.OAuth}}(this)),define("feed/nolog",[],function(){return function(){}}),define("feed/events",["underscore"],function(e){var t=Array.prototype.slice,n={on:function(e,t,n){if(!i(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(t,n,r){if(!i(this,"once",t,[n,r])||!n)return this;var s=this,o=e.once(function(){s.off(t,o),n.apply(this,arguments)});return o._callback=n,this.on(t,o,r)},off:function(t,n,r){var s,o,u,a,f,l,c,h;if(!this._events||!i(this,"off",t,[n,r]))return this;if(!t&&!n&&!r)return this._events={},this;a=t?[t]:e.keys(this._events);for(f=0,l=a.length;f<l;f++){t=a[f];if(u=this._events[t]){this._events[t]=s=[];if(n||r)for(c=0,h=u.length;c<h;c++)o=u[c],(n&&n!==o.callback&&n!==o.callback._callback||r&&r!==o.context)&&s.push(o);s.length||delete this._events[t]}}return this},trigger:function(e){if(!this._events)return this;var n=t.call(arguments,1);if(!i(this,"trigger",e,n))return this;var r=this._events[e],o=this._events.all;return r&&s(r,n),o&&s(o,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;typeof t=="object"&&(n=this),e&&((r={})[e._listenerId]=e);for(var s in r)r[s].off(t,n,this),i&&delete this._listeners[s];return this}},r=/\s+/,i=function(e,t,n,i){if(!n)return!0;if(typeof n=="object"){for(var s in n)e[t].apply(e,[s,n[s]].concat(i));return!1}if(r.test(n)){var o=n.split(r);for(var u=0,a=o.length;u<a;u++)e[t].apply(e,[o[u]].concat(i));return!1}return!0},s=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},o={listenTo:"on",listenToOnce:"once"};return e.each(o,function(t,r){n[r]=function(n,r,i){var s=this._listeners||(this._listeners={}),o=n._listenerId||(n._listenerId=e.uniqueId("l"));return s[o]=n,typeof r=="object"&&(i=this),n[t](r,i,this),this}}),n}),define("feed/util",[],function(){var e={};return e.addProtocol=function(e,t){return e.slice(0,2)==="//"&&(t===!0?e="https:"+e:t===!1?e="http:"+e:window.location.protocol.substr(0,4)==="http"?e=window.location.protocol+e:e="http"),e},e}),function(e){typeof define=="function"&&define.amd?define("jquery.cookie",["jquery"],e):e(jQuery)}(function(e){function n(e){return e}function r(e){return decodeURIComponent(e.replace(t," "))}function i(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return s.json?JSON.parse(e):e}catch(t){}}var t=/\+/g,s=e.cookie=function(t,o,u){if(o!==undefined){u=e.extend({},s.defaults,u);if(typeof u.expires=="number"){var a=u.expires,f=u.expires=new Date;f.setDate(f.getDate()+a)}return o=s.json?JSON.stringify(o):String(o),document.cookie=[s.raw?t:encodeURIComponent(t),"=",s.raw?o:encodeURIComponent(o),u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join("")}var l=s.raw?n:r,c=document.cookie.split("; "),h=t?undefined:{};for(var p=0,d=c.length;p<d;p++){var v=c[p].split("="),m=l(v.shift()),g=l(v.join("="));if(t&&t===m){h=i(g);break}t||(h[m]=i(g))}return h};s.defaults={},e.removeCookie=function(t,n){return e.cookie(t)!==undefined?(e.cookie(t,"",e.extend(n,{expires:-1})),!0):!1}}),function(){var e=CryptoJS,t=e.lib,n=t.WordArray,r=e.enc,i=r.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();var i=[];for(var s=0;s<n;s+=3){var o=t[s>>>2]>>>24-s%4*8&255,u=t[s+1>>>2]>>>24-(s+1)%4*8&255,a=t[s+2>>>2]>>>24-(s+2)%4*8&255,f=o<<16|u<<8|a;for(var l=0;l<4&&s+l*.75<n;l++)i.push(r.charAt(f>>>6*(3-l)&63))}var c=r.charAt(64);if(c)while(i.length%4)i.push(c);return i.join("")},parse:function(e){e=e.replace(/\s/g,"");var t=e.length,r=this._map,i=r.charAt(64);if(i){var s=e.indexOf(i);s!=-1&&(t=s)}var o=[],u=0;for(var a=0;a<t;a++)if(a%4){var f=r.indexOf(e.charAt(a-1))<<a%4*2,l=r.indexOf(e.charAt(a))>>>6-a%4*2;o[u>>>2]|=(f|l)<<24-u%4*8,u++}return n.create(o,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),define("enc-base64",function(){}),define("feed/session",["underscore","jquery","CryptoJS","OAuth","feed/log","feed/events","feed/util","jquery.cookie","enc-base64"],function(e,t,n,r,i,s,o){function a(e,t,n){e=e?2*e:200,e>t&&(e=t),setTimeout(function(){n(e)},e)}function f(){try{return"localStorage"in window&&window.localStorage!==null}catch(e){return i("browser does not support html5 localstorage",e.message),!1}}r.SignatureMethod.registerMethodClass(["HMAC-SHA256","HMAC-SHA256-Accessor"],r.SignatureMethod.makeSubclass(function(t){var r=n.HmacSHA256(t,this.key),i=r.toString(n.enc.Base64);return i}));var u=function(t,n,r){r=r||{},this.config={baseUrl:o.addProtocol(r.baseUrl||"//feed.fm",r.secure),secure:!!r.secure,formats:"mp3,aac",maxBitrate:128,timeOffset:0,current:null,pendingRequest:null,pendingPlay:null},e.extend(this,s),t&&n&&this.setCredentials(t,n)};u.prototype.setBaseUrl=function(e){this.config.baseUrl=o.addProtocol(e)},u.prototype.setCredentials=function(e,t){this.config.token=e,this.config.secret=t},u.prototype._synchronizeClock=function(){var e=this;this._ajax({url:this.config.baseUrl+"/api/v2/oauth/time",type:"GET"}).then(function(t){if(t&&t.success){var n=t.result,r=Date.now()/1e3;e.config.timeSkew=n-r}}).fail(function(){i("clock synchronization failed")})},u.prototype.setPlacementId=function(e){this.config.placementId=e,this.trigger("placement-changed",e),this._retune()},u.prototype.setStationId=function(e){this.config.stationId=e,this.trigger("station-changed",e),this._retune()},u.prototype.setFormats=function(e){this.config.formats=e,this._retune()},u.prototype.setMaxBitrate=function(e){this.config.maxBitrate=e},u.prototype.tune=function(){if(!this.config.token)throw new Error("no token set with setCredentials()");if(!this.config.secret)throw new Error("no secret set with setCredentials()");this.config.pendingRequest=null,this.config.pendingPlay=null,this._assignCurrentPlay(null,!0),this.config.placementId?this._getPlacementInformation():this._getDefaultPlacementInformation()},u.prototype._getDefaultPlacementInformation=function(t){var n=this;if(this.config.placementId&&this.config.placement&&this.config.placement.id===this.config.placementId)return;var r={url:n.config.baseUrl+"/api/v2/placement",type:"GET",dataType:"json",timeout:6e3};i("requesting default placement information from server"),n._signedAjax(r).done(e.bind(n._receiveDefaultPlacementInformation,n)).fail(e.bind(n._failedDefaultPlacementInformation,n,t))},u.prototype._receiveDefaultPlacementInformation=function(e){e&&e.success&&e.placement&&(this.config.placement=e.placement,this.config.stations=e.stations,this.config.placementId=e.placement.id,this.trigger("placement-changed",this.config.placementId),this.trigger("placement",e.placement),!("stationId"in this.config)&&e.stations.length>0&&(this.config.stationId=e.stations[0].id,this.trigger("station-changed",this.config.stationId)),this.trigger("stations",e.stations),this._requestNextPlay())},u.prototype._failedDefaultPlacementInformation=function(n,r){if(r.status===401)try{var i=t.parseJSON(r.responseText);if(i.error&&i.error.code===5){this.trigger("invalid-credentials");return}}catch(s){}n=n?n*2:500,e.delay(e.bind(this._getDefaultPlacementInformation,this,n),n)},u.prototype._getPlacementInformation=function(t){var n=this;if(!this.config.placementId)throw new Error("no placementId set");if(this.config.placement&&this.config.placement.id===this.config.placementId){this._requestNextPlay();return}var r={url:n.config.baseUrl+"/api/v2/placement/"+n.config.placementId,type:"GET",dataType:"json",timeout:6e3};i("requesting placement information from server"),n._signedAjax(r).done(e.bind(n._receivePlacementInformation,n)).fail(e.bind(n._failedPlacementInformation,n,t,r))},u.prototype._receivePlacementInformation=function(e){e&&e.success&&e.placement&&(this.config.placement=e.placement,this.config.stations=e.stations,this.trigger("placement",e.placement),!("stationId"in this.config)&&e.stations.length>0&&(this.config.stationId=e.stations[0].id,this.trigger("station-changed",this.config.stationId)),this.trigger("stations",e.stations),this._requestNextPlay())},u.prototype._failedPlacementInformation=function(t){t=t?t*2:500,e.delay(e.bind(this._getPlacementInformation,this,t),t)},u.prototype.getActivePlacement=function(){return this.config.placement?this.config.placement:null},u.prototype.getActivePlay=function(){return this.config.current?this.config.current.play:null},u.prototype.isTuned=function(){return this.config.current||this.config.pendingRequest},u.prototype.hasActivePlayStarted=function(){return this.config.current&&this.config.current.started},u.prototype._retune=function(){if(!this.isTuned())return;this.tune()},u.prototype.reportPlayStarted=function(){if(!this.config.current)throw new Error("attempt to report a play started, but there is no active play");this._startPlay(this.config.current.play)},u.prototype.reportPlayElapsed=function(e){if(!this.config.current)throw new Error("attempt to report elapsed play time, but the play hasn't started");this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+this.config.current.play.id+"/elapse",type:"POST",data:{seconds:e}})},u.prototype.reportPlayCompleted=function(){var t=this;if(!this.config.current||!this.config.current.started)throw i("finish on non-active or playing song"),new Error("no active or playing song");this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+this.config.current.play.id+"/complete",type:"POST"}).always(e.bind(t._receivePlayCompleted,t))},u.prototype._receivePlayCompleted=function(){if(!this.config.pendingRequest){i("song finished, and no outstanding request, so playing pendingPlay");var e=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(e)}else i("song finished, but we're still waiting for next one to return"),this._assignCurrentPlay(null,!0)},u.prototype.requestSkip=function(){if(!this.config.current)throw new Error("No song being played");if(!this.config.current.started)throw new Error("No song has been started");if(!this.config.current.canSkip){this.trigger("skip-denied");return}this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+this.config.current.play.id+"/skip",type:"POST"}).done(e.bind(this._receiveSkip,this,this.config.current.play)).fail(e.bind(this._failSkip,this,this.config.current.play))},u.prototype.requestInvalidate=function(){if(!this.config.current)throw new Error("No active song to invalidate!");this._sendInvalidate(this.config.current.play)},u.prototype._sendInvalidate=function(t,n){this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+t.id+"/invalidate",type:"POST"}).done(e.bind(this._receiveInvalidate,this,t)).fail(e.bind(this._failInvalidate,this,n,t))},u.prototype._failInvalidate=function(t,n,r){var s=this;t=t?t*2:200,t<3e3?e.delay(function(){s._sendInvalidate(n)},t):i("gave up trying to invalidate play",r)},u.prototype._receiveInvalidate=function(e,t){if(!this.config.current||this.config.current.play!==e)return;if(!t.success){i("failed invalidate! - technically this is impossible");return}if(this.config.pendingPlay){i("invalidating to song already queued up");var n=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(n)}else i("invalidating current song"),this._assignCurrentPlay(null,!0),this.config.pendingRequest||(i("queueing up new song"),this._requestNextPlay())},u.prototype._failSkip=function(e){if(!this.config.current||this.config.current.play!==e)return;this.trigger("skip-denied")},u.prototype._receiveSkip=function(e,t){if(!this.config.current||this.config.current.play!==e)return;if(!t.success){i("failed skip!"),this.trigger("skip-denied");return}if(this.config.pendingPlay){i("skipping to song already queued up");var n=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(n)}else this.config.pendingRequest?(i("skipping to what is queued up"),this._assignCurrentPlay(null,!0)):(i("skipping to what is queued up"),this._assignCurrentPlay(null))},u.prototype._startPlay=function(t){this.config.current.retryCount>2?this._receiveStartPlay(t,{success:!0,can_skip:!0}):(i("telling server we're starting the play",t),this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+t.id+"/start",type:"POST",dataType:"json",timeout:3e3}).done(e.bind(this._receiveStartPlay,this,t)).fail(e.bind(this._failStartPlay,this,t)))},u.prototype._receiveStartPlay=function(e,t){t.success?this.config.current&&this.config.current.play===e?(this.config.current.canSkip=t.can_skip,this.config.current.started=!0,this.trigger("play-started",e),this._requestNextPlay()):i("received start play, but not waiting any more"):i("received failed start success")},u.prototype._failStartPlay=function(n,r){if(this.config.current&&this.config.current.play===n){if(r.status===403)try{var s=t.parseJSON(r.responseText);if(s.error&&s.error.code===20)return this._receiveStartPlay(n,{success:!0,can_skip:!0})}catch(o){i("unable to parse start play response",o.message)}i("request failed - trying again in 1 second",r.status),this.config.current.retryCount++,e.delay(e.bind(this._startPlay,this,n),1e3)}else i("startPlay failed, but we don't care any more")},u.prototype._assignCurrentPlay=function(e,t){this.config.current&&(this.trigger("play-completed",this.config.current.play),this.config.current=null),e===null?t?i("nothing to play... waiting"):(i("nothing to play from the current station"),this.trigger("plays-exhausted")):(this.config.current={play:e,canSkip:!1,started:!1,retryCount:0},i("activated new song"),this.trigger("play-active",e))},u.prototype._requestNextPlay=function(t){var n=this;this._getClientId().then(function(){if(n.config.pendingRequest){if(!t){i("already waiting for a request to finish");return}if(t>6e4){i("giving up on retrieving next play"),n.config.pendingRequest=null,n.config.current==null&&n._assignCurrentPlay(null);return}i("retrying pending request"),n.config.pendingRequest.retryCount++,n._signedAjax(n.config.pendingRequest.ajax).done(e.bind(n._receiveNextPlay,n,n.config.pendingRequest.ajax)).fail(e.bind(n._failedNextPlay,n,t,n.config.pendingRequest.ajax));return}var r={url:n.config.baseUrl+"/api/v2/play",type:"POST",dataType:"json",timeout:6e3,data:{formats:n.config.formats,client_id:n.config.clientId,max_bitrate:n.config.maxBitrate,secure:n.config.secure}};n.config.placementId&&(r.data.placement_id=n.config.placementId),n.config.stationId&&(r.data.station_id=n.config.stationId),n.config.pendingRequest={ajax:r,retryCount:0},i("requesting new play from server",r),n._signedAjax(r).done(e.bind(n._receiveNextPlay,n,r)).fail(e.bind(n._failedNextPlay,n,t,r))})},u.prototype._receiveNextPlay=function(e,t){this.config.pendingRequest&&this.config.pendingRequest.ajax===e?(this.config.pendingRequest=null,t.success?this.config.current?(i("received play, but we're already playing, so queueing up",t.play),this.config.pendingPlay=t.play):(i("received play and no current song, so playing now",t.play),this._assignCurrentPlay(t.play)):t.error&&t.error.code===9?this.config.current?(i("ran out of music to play, but we're already playing"),this.config.pendingPlay=null):(i("ran out of music, and nothing playing now"),this.trigger("plays-exhausted")):i("unsuccessful response",t)):i("nextPlay succeeded, but we don't care")},u.prototype._failedNextPlay=function(n,r,s){if(this.config.pendingRequest&&this.config.pendingRequest.ajax===r){if(s.status===403)try{var o=t.parseJSON(s.responseText);if(o.error&&o.error.code===19){this.trigger("not-in-us",o.error.message);return}}catch(u){i("problem parsing 403 response",u.message)}i("request failed - trying again",s.status),n=n?n*2:500,e.delay(e.bind(this._requestNextPlay,this,n),n)}else i("nextPlay failed, but we don't care")},u.prototype._synchronizeServerTime=function(){if(this.timePromise)return this.timePromise;var e=t.Deferred();this.timePromise=e.promise();var n=this;return e.then(function(e){var t=n._unixTime();n.config.timeOffset=e-t}),this._requestServerTime(e),this.timePromise},u.prototype._requestServerTime=function(e,t){var n=this;this._ajax({url:n.config.baseUrl+"/api/v2/oauth/time",type:"GET"}).done(function(r){r.success?e.resolve(r.time):a(t,2e3,function(t){n._requestServerTime(e,t)})}).fail(function(){a(t,2e3,function(t){n._requestServerTime(e,t)})})},u.prototype._getClientId=function(){if(this.clientPromise)return this.clientPromise;var e=new t.Deferred;this.clientPromise=e.promise();var n=this;return this._requestClientId(function(t){n.config.clientId=t,n._setStoredCid(n.config.clientId),e.resolve(t)}),this.clientPromise},u.prototype._requestClientId=function(e,n){var r=this._getStoredCid();if(r)return e(r);var s=this;this._signedAjax({url:s.config.baseUrl+"/api/v2/client",type:"POST"}).done(function(t){t.success?e(t.client_id):a(n,2e3,function(t){s._requestClientId(e,t)})}).fail(function(r){if(r.status===403)try{var o=t.parseJSON(r.responseText);if(o.error&&o.error.code===19){s.trigger("not-in-us",o.error.message);return}}catch(u){i("unknown response for client id request",u.message)}else i("unknown client id response status",r.status);a(n,2e3,function(t){s._requestClientId(e,t)})})},u.prototype.maybeCanSkip=function(){return this.config.current&&this.config.current.started&&this.config.current.canSkip},u.prototype.likePlay=function(e){this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+e+"/like",type:"POST"}),this.config.current&&this.config.current.play.id===e&&(this.config.current.play.liked=!0)},u.prototype.unlikePlay=function(e){this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+e+"/like",type:"DELETE"}),this.config.current&&this.config.current.play.id===e&&delete this.config.current.play.liked},u.prototype.dislikePlay=function(e){this._signedAjax({url:this.config.baseUrl+"/api/v2/play/"+e+"/dislike",type:"POST"}),this.config.current&&this.config.current.play.id===e&&(this.config.current.play.liked=!1)},u.prototype.suspend=function(t){var n={};return this.config.placementId&&(n.placementId=this.config.placementId),this.config.stationId&&(n.stationId=this.config.stationId),this.config.current&&this.config.current.started&&(n.placement=this.config.placement,n.stations=this.config.stations,n.play=e.clone(this.config.current.play),n.play.startPosition=t,n.canSkip=this.config.current.canSkip),n},u.prototype.unsuspend=function(e){if(this.getActivePlay())throw new Error("You cannot unsuspend after running tune()");return"placementId"in e&&(this.config.placementId=e.placementId,this.trigger("placement-changed",this.config.placementId)),"stationId"in e&&(this.config.stationId=e.stationId,this.trigger("station-changed",this.config.stationId)),"play"in e?(this.config.placement=e.placement,this.config.stations=e.stations,this.trigger("placement",this.config.placement),this.trigger("stations",this.config.stations),this._assignCurrentPlay(e.play),this._receiveStartPlay(e.play,{success:!0,can_skip:e.canSkip}),e.play):(this.tune(),null)};var l="cid";return u.prototype._getStoredCid=function(){return f()?localStorage[l]:t.cookie(l)},u.prototype._setStoredCid=function(e){f()?localStorage[l]=e:t.cookie(l,e,{expires:3650,path:"/"})},u.prototype._deleteStoredCid=function(){f()?localStorage.removeItem(l):t.removeCookie(l,{path:"/"})},u.prototype._unixTime=function(){return Math.floor(Date.now()/1e3)},u.prototype._makeNonce=function(){return Math.random().toString(36).substring(8)},u.prototype._sign=function(e){var i;if(e.url.slice(0,5)==="https")i="Basic "+n.enc.Base64.stringify(n.enc.Latin1.parse(this.config.token+":"+this.config.secret));else{var s={action:e.url,method:e.type,parameters:{oauth_timestamp:this._unixTime()+this.config.timeOffset,oauth_nonce:this._makeNonce(),oauth_signature_method:"HMAC-SHA256"}};t.extend(s.parameters,e.data),r.completeRequest(s,{consumerKey:this.config.token,consumerSecret:this.config.secret}),i=r.getAuthorizationHeader("Feed.fm",s.parameters)}return e.headers={Authorization:i},e},u.prototype._signedAjax=function(e){var n=this,r=t.Deferred();return this._synchronizeServerTime().then(function(){n._ajax(n._sign(e)).then(function(e){r.resolve(e)}).fail(function(e){r.reject(e)})}),r},u.prototype._ajax=function(e){return t.ajax(e)},u}),define("feed/player-view",["underscore","jquery"],function(e,t){function r(e){var t=Math.floor(e/1e3),n=t%60,r=Math.floor(t/60);return n<10&&(n="0"+n),r+":"+n}var n=function(n,r){this.id=n,this.alertId=null,this.durationId=null,this.startedPlayback=!1,this.$el=t("#"+n),this.player=r,this.player.on("placement",this._onPlacement,this),this.player.on("play-started",this._onPlayStarted,this),this.player.on("play-paused",this._onPlayPaused,this),this.player.on("play-resumed",this._onPlayResumed,this),this.player.on("play-completed",this._onPlayCompleted,this),this.player.on("play-liked",this._onPlayLiked,this),this.player.on("play-unliked",this._onPlayUnliked,this),this.player.on("play-disliked",this._onPlayDisliked,this),this.player.on("plays-exhausted",this._onPlaysExhausted,this),this.player.on("skip-denied",this._onSkipDenied,this),this.player.on("suspend",this._onSuspend,this),this._enableButtonsBasedOnState(),this.displayText=this.originalDisplayText=this.$(".status").html(),this.renderStatus(),this.$el.on("click",".status",e.bind(this._onStatusClick,this)),this.$el.on("click",".play-button, .start-button, .resume-button",e.bind(this._onPlayButtonClick,this)),this.$el.on("click",".pause-button",e.bind(this._onPauseButtonClick,this)),this.$el.on("click",".skip-button",e.bind(this._onSkipButtonClick,this)),this.$el.on("click",".like-button",e.bind(this._onLikeButtonClick,this)),this.$el.on("click",".dislike-button",e.bind(this._onDislikeButtonClick,this))};return n.prototype._onStatusClick=function(){var e=this.player.getCurrentState();e==="playing"?this._onPauseButtonClick():this._onPlayButtonClick()},n.prototype._onPlayButtonClick=function(){this.player.play()},n.prototype._onPauseButtonClick=function(){this.player.pause()},n.prototype._onSkipButtonClick=function(){this.player.skip()},n.prototype._onLikeButtonClick=function(e){t(e.target).closest(".like-button").is(".liked")?this.player.unlike():this.player.like()},n.prototype._onDislikeButtonClick=function(){this.player.dislike()},n.prototype.$=function(e){return this.$el.find(e)},n.prototype._onPlacement=function(e){this._originalDisplayText||(this.originalDisplayText=this.formatPlacement(e),this.renderStatus(this.originalDisplayText))},n.prototype.formatPlacement=function(e){return"Tune in to <em class='placement'>"+e.name+"</em>"},n.prototype._onPlayStarted=function(e){this.startedPlayback=!0,this.renderStatus(this.formatPlay(e)),this._enableButtonsBasedOnState(),this._setLikeStatus(e.liked),this._enablePositionTracker()},n.prototype._enablePositionTracker=function(){var e=this;this.durationId||(this.durationId=window.setInterval(function(){e.renderPosition(e.player.getPosition(),e.player.getDuration())},500))},n.prototype._setLikeStatus=function(e){e===!0?(this.$(".like-button").addClass("liked"),this.$(".dislike-button").removeClass("disliked")):e===!1?(this.$(".like-button").removeClass("liked"),this.$(".dislike-button").addClass("disliked")):(this.$(".like-button").removeClass("liked"),this.$(".dislike-button").removeClass("disliked"))},n.prototype._disablePositionTracker=function(){this.durationId&&(window.clearInterval(this.durationId),this.durationId=null)},n.prototype._onPlayResumed=function(){this._enablePositionTracker(),this._enableButtonsBasedOnState()},n.prototype._onPlayPaused=function(){this._disablePositionTracker(),this._enableButtonsBasedOnState()},n.prototype._onPlayCompleted=function(){this.renderPosition(0,0),this._enableButtonsBasedOnState()},n.prototype._onPlaysExhausted=function(){this.renderStatus(this.originalDisplayText),this.renderAlert("There is no more music to play in this station!"),this._enableButtonsBasedOnState()},n.prototype._onPlayLiked=function(){this._setLikeStatus(!0)},n.prototype._onPlayDisliked=function(){this._setLikeStatus(!1)},n.prototype._onPlayUnliked=function(){this._setLikeStatus()},n.prototype._onSkipDenied=function(){this.renderAlert("Sorry you've temporarily run out of skips!")},n.prototype.formatPlay=function(e){return"<span class='track'>"+e.audio_file.track.title+"</span> by <span class='artist'>"+e.audio_file.artist.name+"</span> on <span class='release'>"+e.audio_file.release.title+"</span>"},n.prototype.renderStatus=function(e){e!==undefined&&(this.displayText=e),this.alertId||this.$(".status").html(this.displayText).removeClass("alert")},n.prototype.renderPosition=function(e,t){this.$(".elapsed").html(r(e)),this.$(".duration").html(r(t));if(t===0)this.$(".progress").css("width","0");else{var n=Math.round((e+1e3)/t*100);n=n>100?100:n,this.$(".progress").css("width",n+"%")}},n.prototype.renderAlert=function(e){this.alertId&&window.clearTimeout(this.alertId),this.$(".status").html(e).addClass("alert");var t=this;this.alertId=window.setTimeout(function(){t.alertId=null,t.renderStatus()},3e3)},n.prototype._onSuspend=function(){this._enableButtonsBasedOnState()},n.prototype._enableButtonsBasedOnState=function(){var e=this.player.getCurrentState(),t,n;switch(e){case"playing":t=".pause-button, .like-button, .dislike-button",n=".play-button, .start-button, .resume-button",this.player.maybeCanSkip()?t+=", .skip-button":n+=", .skip-button";break;case"paused":t=".play-button, .resume-button, .like-button, .dislike-button",n=".pause-button, .start-button",this.player.maybeCanSkip()?t+=", .skip-button":n+=", .skip-button";break;case"suspended":t="",n=".play-button, .resume-button, .like-button, .dislike-button, .pause-button, .start-button, .skip-button";break;default:t=".play-button, .start-button",n=".resume-button, .pause-button, .like-button, .dislike-button, .skip-button"}this.$(n).removeClass("button-enabled").addClass("button-disabled").attr("disabled","true"),t&&this.$(t).removeClass("button-disabled").addClass("button-enabled").removeAttr("disabled"),this.$el.removeClass("state-playing state-paused state-idle state-suspended").addClass("state-"+e)},n}),function(e,t){function r(n,r){function hn(e){return s.preferFlash&&Bt&&!s.ignoreFlash&&s.flash[e]!==t&&s.flash[e]}function pn(e){return function(t){var n=this._s,r;return!n||!n._a?r=null:r=e.call(this,t),r}}this.setupOptions={url:n||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,console:null,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,html5Test:/^(probably|maybe)$/i,preferFlash:!1,noSWFCache:!1,idPrefix:"sound"},this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100},this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null},this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null},this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},opus:{type:["audio/ogg; codecs=opus","audio/opus"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}},this.movieID="sm2-container",this.id=r||"sm2movie",this.debugID="soundmanager-debug",this.debugURLParam=/([#?&])debug=1/i,this.versionNumber="V2.97a.20131201",this.version=null,this.movieURL=null,this.altURL=null,this.swfLoaded=!1,this.enabled=!1,this.oMC=null,this.sounds={},this.soundIDs=[],this.muted=!1,this.didFlashBlock=!1,this.filePattern=null,this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i},this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1},this.sandbox={},this.html5={usingFlash:null},this.flash={},this.html5Only=!1,this.ignoreFlash=!1;var i,s=this,o=null,u=null,a="soundManager",f=a+": ",l="HTML5::",c,h=navigator.userAgent,p=e.location.href.toString(),d=document,v,m,g,y,b=[],w=!0,E,S=!1,x=!1,T=!1,N=!1,C=!1,k,L=0,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y=["log","info","warn","error"],Z=8,et,tt,nt,rt=null,it=null,st,ot,ut,at,ft,lt,ct,ht,pt,dt=!1,vt=!1,mt,gt,yt,bt=0,wt=null,Et,St=[],xt,Tt=null,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt=Array.prototype.slice,Pt=!1,Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt=0,Wt=h.match(/(ipad|iphone|ipod)/i),Xt=h.match(/android/i),Vt=h.match(/msie/i),$t=h.match(/webkit/i),Jt=h.match(/safari/i)&&!h.match(/chrome/i),Kt=h.match(/opera/i),Qt=h.match(/(mobile|pre\/|xoom)/i)||Wt||Xt,Gt=!p.match(/usehtml5audio/i)&&!p.match(/sm2\-ignorebadua/i)&&Jt&&!h.match(/silk/i)&&h.match(/OS X 10_6_([3-7])/i),Yt=e.console!==t&&console.log!==t,Zt=d.hasFocus!==t?d.hasFocus():null,en=Jt&&(d.hasFocus===t||!d.hasFocus()),tn=!en,nn=/(mp3|mp4|mpa|m4a|m4b)/i,rn=1e3,sn="about:blank",on="data:audio/wave;base64,/UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQIAAAD//w==",un=d.location?d.location.protocol.match(/http/i):null,an=un?"":"http://",fn=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,ln=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","m4b","mp4v","3gp","3g2"],cn=new RegExp("\\.("+ln.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i,this.useAltURL=!un,at={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"},this.hasHTML5=function(){try{return Audio!==t&&(Kt&&opera!==t&&opera.version()<10?new Audio(null):new Audio).canPlayType!==t}catch(e){return!1}}(),this.setup=function(e){var n=!s.url;return e!==t&&T&&Tt&&s.ok()&&(e.flashVersion!==t||e.url!==t||e.html5Test!==t),M(e),e&&(n&&V&&e.url!==t&&s.beginDelayedInit(),!V&&e.url!==t&&d.readyState==="complete"&&setTimeout(W,1)),s},this.ok=function(){return Tt?T&&!N:s.useHTML5Audio&&s.hasHTML5},this.supported=this.ok,this.getMovie=function(t){return c(t)||d[t]||e[t]},this.createSound=function(e,n){function l(){return a=lt(a),s.sounds[a.id]=new i(a),s.soundIDs.push(a.id),s.sounds[a.id]}var r,o,a,f=null;if(!T||!s.ok())return!1;n!==t&&(e={id:e,url:n}),a=O(e),a.url=Et(a.url),a.id===undefined&&(a.id=s.setupOptions.idPrefix+zt++);if(pt(a.id,!0))return s.sounds[a.id];if(Ct(a))f=l(),f._setup_html5(a);else{if(s.html5Only)return l();if(s.html5.usingFlash&&a.url&&a.url.match(/data\:/i))return l();y>8&&a.isMovieStar===null&&(a.isMovieStar=!!(a.serverURL||(a.type?a.type.match(fn):!1)||a.url&&a.url.match(cn))),a=ct(a,r),f=l(),y===8?u._createSound(a.id,a.loops||1,a.usePolicyFile):(u._createSound(a.id,a.url,a.usePeakData,a.useWaveformData,a.useEQData,a.isMovieStar,a.isMovieStar?a.bufferTime:!1,a.loops||1,a.serverURL,a.duration||null,a.autoPlay,!0,a.autoLoad,a.usePolicyFile),a.serverURL||(f.connected=!0,a.onconnect&&a.onconnect.apply(f))),!a.serverURL&&(a.autoLoad||a.autoPlay)&&f.load(a)}return!a.serverURL&&a.autoPlay&&f.play(),f},this.destroySound=function(e,t){if(!pt(e))return!1;var n=s.sounds[e],r;n._iO={},n.stop(),n.unload();for(r=0;r<s.soundIDs.length;r++)if(s.soundIDs[r]===e){s.soundIDs.splice(r,1);break}return t||n.destruct(!0),n=null,delete s.sounds[e],!0},this.load=function(e,t){return pt(e)?s.sounds[e].load(t):!1},this.unload=function(e){return pt(e)?s.sounds[e].unload():!1},this.onPosition=function(e,t,n,r){return pt(e)?s.sounds[e].onposition(t,n,r):!1},this.onposition=this.onPosition,this.clearOnPosition=function(e,t,n){return pt(e)?s.sounds[e].clearOnPosition(t,n):!1},this.play=function(e,t){var n=null,r=t&&!(t instanceof Object);if(!T||!s.ok())return!1;if(!pt(e,r)){if(!r)return!1;r&&(t={url:t}),t&&t.url&&(t.id=e,n=s.createSound(t).play())}else r&&(t={url:t});return n===null&&(n=s.sounds[e].play(t)),n},this.start=this.play,this.setPosition=function(e,t){return pt(e)?s.sounds[e].setPosition(t):!1},this.stop=function(e){return pt(e)?s.sounds[e].stop():!1},this.stopAll=function(){var e;for(e in s.sounds)s.sounds.hasOwnProperty(e)&&s.sounds[e].stop()},this.pause=function(e){return pt(e)?s.sounds[e].pause():!1},this.pauseAll=function(){var e;for(e=s.soundIDs.length-1;e>=0;e--)s.sounds[s.soundIDs[e]].pause()},this.resume=function(e){return pt(e)?s.sounds[e].resume():!1},this.resumeAll=function(){var e;for(e=s.soundIDs.length-1;e>=0;e--)s.sounds[s.soundIDs[e]].resume()},this.togglePause=function(e){return pt(e)?s.sounds[e].togglePause():!1},this.setPan=function(e,t){return pt(e)?s.sounds[e].setPan(t):!1},this.setVolume=function(e,t){return pt(e)?s.sounds[e].setVolume(t):!1},this.mute=function(e){var t=0;e instanceof String&&(e=null);if(!e){for(t=s.soundIDs.length-1;t>=0;t--)s.sounds[s.soundIDs[t]].mute();return s.muted=!0,!0}return pt(e)?s.sounds[e].mute():!1},this.muteAll=function(){s.mute()},this.unmute=function(e){var t;e instanceof String&&(e=null);if(!e){for(t=s.soundIDs.length-1;t>=0;t--)s.sounds[s.soundIDs[t]].unmute();return s.muted=!1,!0}return pt(e)?s.sounds[e].unmute():!1},this.unmuteAll=function(){s.unmute()},this.toggleMute=function(e){return pt(e)?s.sounds[e].toggleMute():!1},this.getMemoryUse=function(){var e=0;return u&&y!==8&&(e=parseInt(u._getMemoryUse(),10)),e},this.disable=function(n){var r;n===t&&(n=!1);if(N)return!1;N=!0;for(r=s.soundIDs.length-1;r>=0;r--)et(s.sounds[s.soundIDs[r]]);return A(n),_t.remove(e,"load",H),!0},this.canPlayMIME=function(e){var t;return s.hasHTML5&&(t=kt({type:e})),!t&&Tt&&(t=e&&s.ok()?!!((y>8?e.match(fn):null)||e.match(s.mimePattern)):null),t},this.canPlayURL=function(e){var t;return s.hasHTML5&&(t=kt({url:e})),!t&&Tt&&(t=e&&s.ok()?!!e.match(s.filePattern):null),t},this.canPlayLink=function(e){return e.type!==t&&e.type&&s.canPlayMIME(e.type)?!0:s.canPlayURL(e.href)},this.getSoundById=function(e,t){if(!e)return null;var n=s.sounds[e];return n},this.onready=function(t,n){var r="onready",i=!1;if(typeof t!="function")throw st("needFunction",r);return n||(n=e),D(r,t,n),P(),i=!0,i},this.ontimeout=function(t,n){var r="ontimeout",i=!1;if(typeof t!="function")throw st("needFunction",r);return n||(n=e),D(r,t,n),P({type:r}),i=!0,i},this.console={log:!1},this._writeDebug=function(e,t){return!0},this._wD=this._writeDebug,this._debug=function(){},this.reboot=function(t,n){var r,i,o;for(r=s.soundIDs.length-1;r>=0;r--)s.sounds[s.soundIDs[r]].destruct();if(u)try{Vt&&(it=u.innerHTML),rt=u.parentNode.removeChild(u)}catch(a){}it=rt=Tt=u=null,s.enabled=V=T=dt=vt=S=x=N=Pt=s.swfLoaded=!1,s.soundIDs=[],s.sounds={},zt=0;if(!t){for(r in b)if(b.hasOwnProperty(r))for(i=0,o=b[r].length;i<o;i++)b[r][i].fired=!1}else b=[];return s.html5={usingFlash:null},s.flash={},s.html5Only=!1,s.ignoreFlash=!1,e.setTimeout(function(){z(),n||s.beginDelayedInit()},20),s},this.reset=function(){return s.reboot(!0,!0)},this.getMoviePercent=function(){return u&&"PercentLoaded"in u?u.PercentLoaded():null},this.beginDelayedInit=function(){C=!0,W(),setTimeout(function(){return vt?!1:(J(),U(),vt=!0,!0)},20),B()},this.destruct=function(){s.disable(!0)},i=function(e){var n=this,r,i,a,f,l,c,h=!1,p=[],d=0,v,m,g=null,b,w;b={duration:null,time:null},this.id=e.id,this.sID=this.id,this.url=e.url,this.options=O(e),this.instanceOptions=this.options,this._iO=this.instanceOptions,this.pan=this.options.pan,this.volume=this.options.volume,this.isHTML5=!1,this._a=null,w=this.url?!1:!0,this.id3={},this._debug=function(){},this.load=function(e){var r=null,i;e!==t?n._iO=O(e,n.options):(e=n.options,n._iO=e,g&&g!==n.url&&(n._iO.url=n.url,n.url=null)),n._iO.url||(n._iO.url=n.url),n._iO.url=Et(n._iO.url),n.instanceOptions=n._iO,i=n._iO;if(!i.url&&!n.url)return n;if(i.url===n.url&&n.readyState!==0&&n.readyState!==2)return n.readyState===3&&i.onload&&Ut(n,function(){i.onload.apply(n,[!!n.duration])}),n;n.loaded=!1,n.readyState=1,n.playState=0,n.id3={};if(Ct(i))r=n._setup_html5(i),r._called_load||(n._html5_canplay=!1,n.url!==i.url&&(n._a.src=i.url,n.setPosition(0)),n._a.autobuffer="auto",n._a.preload="auto",n._a._called_load=!0);else{if(s.html5Only)return n;if(n._iO.url&&n._iO.url.match(/data\:/i))return n;try{n.isHTML5=!1,n._iO=ct(lt(i)),i=n._iO,y===8?u._load(n.id,i.url,i.stream,i.autoPlay,i.usePolicyFile):u._load(n.id,i.url,!!i.stream,!!i.autoPlay,i.loops||1,!!i.autoLoad,i.usePolicyFile)}catch(o){K({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}}return n.url=i.url,n},this.unload=function(){return n.readyState!==0&&(n.isHTML5?(f(),n._a&&(n._a.pause(),g=At(n._a))):y===8?u._unload(n.id,sn):u._unload(n.id),r()),n},this.destruct=function(e){n.isHTML5?(f(),n._a&&(n._a.pause(),At(n._a),Pt||a(),n._a._s=null,n._a=null)):(n._iO.onfailure=null,u._destroySound(n.id)),e||s.destroySound(n.id,!0)},this.play=function(e,r){var i,o,a,f,p,d,v,g=!0,b=null;r=r===t?!0:r,e||(e={}),n.url&&(n._iO.url=n.url),n._iO=O(n._iO,n.options),n._iO=O(e,n._iO),n._iO.url=Et(n._iO.url),n.instanceOptions=n._iO;if(!n.isHTML5&&n._iO.serverURL&&!n.connected)return n.getAutoPlay()||n.setAutoPlay(!0),n;Ct(n._iO)&&(n._setup_html5(n._iO),l()),n.playState===1&&!n.paused&&(o=n._iO.multiShot,o||(n.isHTML5&&n.setPosition(n._iO.position),b=n));if(b!==null)return b;e.url&&e.url!==n.url&&(!n.readyState&&!n.isHTML5&&y===8&&w?w=!1:n.load(n._iO)),n.loaded||(n.readyState===0?(!n.isHTML5&&!s.html5Only?(n._iO.autoPlay=!0,n.load(n._iO)):n.isHTML5?n.load(n._iO):b=n,n.instanceOptions=n._iO):n.readyState===2&&(b=n));if(b!==null)return b;!n.isHTML5&&y===9&&n.position>0&&n.position===n.duration&&(e.position=0);if(n.paused&&n.position>=0&&(!n._iO.serverURL||n.position>0))n.resume();else{n._iO=O(e,n._iO);if(n._iO.from!==null&&n._iO.to!==null&&n.instanceCount===0&&n.playState===0&&!n._iO.serverURL){f=function(){n._iO=O(e,n._iO),n.play(n._iO)},n.isHTML5&&!n._html5_canplay?(n.load({_oncanplay:f}),b=!1):!n.isHTML5&&!n.loaded&&(!n.readyState||n.readyState!==2)&&(n.load({onload:f}),b=!1);if(b!==null)return b;n._iO=m()}(!n.instanceCount||n._iO.multiShotEvents||n.isHTML5&&n._iO.multiShot&&!Pt||!n.isHTML5&&y>8&&!n.getAutoPlay())&&n.instanceCount++,n._iO.onposition&&n.playState===0&&c(n),n.playState=1,n.paused=!1,n.position=n._iO.position!==t&&!isNaN(n._iO.position)?n._iO.position:0,n.isHTML5||(n._iO=ct(lt(n._iO))),n._iO.onplay&&r&&(n._iO.onplay.apply(n),h=!0),n.setVolume(n._iO.volume,!0),n.setPan(n._iO.pan,!0),n.isHTML5?n.instanceCount<2?(l(),a=n._setup_html5(),n.setPosition(n._iO.position),a.play()):(p=new Audio(n._iO.url),d=function(){_t.remove(p,"ended",d),n._onfinish(n),At(p),p=null},v=function(){_t.remove(p,"canplay",v);try{p.currentTime=n._iO.position/rn}catch(e){}p.play()},_t.add(p,"ended",d),n._iO.volume!==undefined&&(p.volume=Math.max(0,Math.min(1,n._iO.volume/100))),n.muted&&(p.muted=!0),n._iO.position?_t.add(p,"canplay",v):p.play()):(g=u._start(n.id,n._iO.loops||1,y===9?n.position:n.position/rn,n._iO.multiShot||!1),y===9&&!g&&n._iO.onplayerror&&n._iO.onplayerror.apply(n))}return n},this.start=this.play,this.stop=function(e){var t=n._iO,r;return n.playState===1&&(n._onbufferchange(0),n._resetOnPosition(0),n.paused=!1,n.isHTML5||(n.playState=0),v(),t.to&&n.clearOnPosition(t.to),n.isHTML5?n._a&&(r=n.position,n.setPosition(0),n.position=r,n._a.pause(),n.playState=0,n._onTimer(),f()):(u._stop(n.id,e),t.serverURL&&n.unload()),n.instanceCount=0,n._iO={},t.onstop&&t.onstop.apply(n)),n},this.setAutoPlay=function(e){n._iO.autoPlay=e,n.isHTML5||(u._setAutoPlay(n.id,e),e&&!n.instanceCount&&n.readyState===1&&n.instanceCount++)},this.getAutoPlay=function(){return n._iO.autoPlay},this.setPosition=function(e){e===t&&(e=0);var r,i,s=n.isHTML5?Math.max(e,0):Math.min(n.duration||n._iO.duration,Math.max(e,0));n.position=s,i=n.position/rn,n._resetOnPosition(n.position),n._iO.position=s;if(!n.isHTML5)r=y===9?n.position:i,n.readyState&&n.readyState!==2&&u._setPosition(n.id,r,n.paused||!n.playState,n._iO.multiShot);else if(n._a){if(n._html5_canplay){if(n._a.currentTime!==i)try{n._a.currentTime=i,(n.playState===0||n.paused)&&n._a.pause()}catch(o){}}else if(i)return n;n.paused&&n._onTimer(!0)}return n},this.pause=function(e){return n.paused||n.playState===0&&n.readyState!==1?n:(n.paused=!0,n.isHTML5?(n._setup_html5().pause(),f()):(e||e===t)&&u._pause(n.id,n._iO.multiShot),n._iO.onpause&&n._iO.onpause.apply(n),n)},this.resume=function(){var e=n._iO;return n.paused?(n.paused=!1,n.playState=1,n.isHTML5?(n._setup_html5().play(),l()):(e.isMovieStar&&!e.serverURL&&n.setPosition(n.position),u._pause(n.id,e.multiShot)),!h&&e.onplay?(e.onplay.apply(n),h=!0):e.onresume&&e.onresume.apply(n),n):n},this.togglePause=function(){return n.playState===0?(n.play({position:y===9&&!n.isHTML5?n.position:n.position/rn}),n):(n.paused?n.resume():n.pause(),n)},this.setPan=function(e,r){return e===t&&(e=0),r===t&&(r=!1),n.isHTML5||u._setPan(n.id,e),n._iO.pan=e,r||(n.pan=e,n.options.pan=e),n},this.setVolume=function(e,r){return e===t&&(e=100),r===t&&(r=!1),n.isHTML5?n._a&&(s.muted&&!n.muted&&(n.muted=!0,n._a.muted=!0),n._a.volume=Math.max(0,Math.min(1,e/100))):u._setVolume(n.id,s.muted&&!n.muted||n.muted?0:e),n._iO.volume=e,r||(n.volume=e,n.options.volume=e),n},this.mute=function(){return n.muted=!0,n.isHTML5?n._a&&(n._a.muted=!0):u._setVolume(n.id,0),n},this.unmute=function(){n.muted=!1;var e=n._iO.volume!==t;return n.isHTML5?n._a&&(n._a.muted=!1):u._setVolume(n.id,e?n._iO.volume:n.options.volume),n},this.toggleMute=function(){return n.muted?n.unmute():n.mute()},this.onPosition=function(e,r,i){return p.push({position:parseInt(e,10),method:r,scope:i!==t?i:n,fired:!1}),n},this.onposition=this.onPosition,this.clearOnPosition=function(e,t){var n;e=parseInt(e,10);if(isNaN(e))return!1;for(n=0;n<p.length;n++)e===p[n].position&&(!t||t===p[n].method)&&(p[n].fired&&d--,p.splice(n,1))},this._processOnPosition=function(){var e,t,r=p.length;if(!r||!n.playState||d>=r)return!1;for(e=r-1;e>=0;e--)t=p[e],!t.fired&&n.position>=t.position&&(t.fired=!0,d++,t.method.apply(t.scope,[t.position]),r=p.length);return!0},this._resetOnPosition=function(e){var t,n,r=p.length;if(!r)return!1;for(t=r-1;t>=0;t--)n=p[t],n.fired&&e<=n.position&&(n.fired=!1,d--);return!0},m=function(){var e=n._iO,t=e.from,r=e.to,i,s;return s=function(){n.clearOnPosition(r,s),n.stop()},i=function(){r!==null&&!isNaN(r)&&n.onPosition(r,s)},t!==null&&!isNaN(t)&&(e.position=t,e.multiShot=!1,i()),e},c=function(){var e,t=n._iO.onposition;if(t)for(e in t)t.hasOwnProperty(e)&&n.onPosition(parseInt(e,10),t[e])},v=function(){var e,t=n._iO.onposition;if(t)for(e in t)t.hasOwnProperty(e)&&n.clearOnPosition(parseInt(e,10))},l=function(){n.isHTML5&&mt(n)},f=function(){n.isHTML5&&gt(n)},r=function(e){e||(p=[],d=0),h=!1,n._hasTimer=null,n._a=null,n._html5_canplay=!1,n.bytesLoaded=null,n.bytesTotal=null,n.duration=n._iO&&n._iO.duration?n._iO.duration:null,n.durationEstimate=null,n.buffered=[],n.eqData=[],n.eqData.left=[],n.eqData.right=[],n.failures=0,n.isBuffering=!1,n.instanceOptions={},n.instanceCount=0,n.loaded=!1,n.metadata={},n.readyState=0,n.muted=!1,n.paused=!1,n.peakData={left:0,right:0},n.waveformData={left:[],right:[]},n.playState=0,n.position=null,n.id3={}},r(),this._onTimer=function(e){var t,r=!1,i,s={};if(n._hasTimer||e)return n._a&&(e||(n.playState>0||n.readyState===1)&&!n.paused)&&(t=n._get_html5_duration(),t!==b.duration&&(b.duration=t,n.duration=t,r=!0),n.durationEstimate=n.duration,i=n._a.currentTime*rn||0,i!==b.time&&(b.time=i,r=!0),(r||e)&&n._whileplaying(i,s,s,s,s)),r},this._get_html5_duration=function(){var e=n._iO,t=n._a&&n._a.duration?n._a.duration*rn:e&&e.duration?e.duration:null,r=t&&!isNaN(t)&&t!==Infinity?t:null;return r},this._apply_loop=function(e,t){e.loop=t>1?"loop":""},this._setup_html5=function(e){var t=O(n._iO,e),s=Pt?o:n._a,u=decodeURI(t.url),a;Pt?u===decodeURI(Ht)&&(a=!0):u===decodeURI(g)&&(a=!0);if(s){if(s._s)if(Pt)s._s&&s._s.playState&&!a&&s._s.stop();else if(!Pt&&u===decodeURI(g))return n._apply_loop(s,t.loops),s;a||(g&&r(!1),s.src=t.url,n.url=t.url,g=t.url,Ht=t.url,s._called_load=!1)}else t.autoLoad||t.autoPlay?(n._a=new Audio(t.url),n._a.load()):n._a=Kt&&opera.version()<10?new Audio(null):new Audio,s=n._a,s._called_load=!1,Pt&&(o=s);return n.isHTML5=!0,n._a=s,s._s=n,i(),n._apply_loop(s,t.loops),t.autoLoad||t.autoPlay?n.load():(s.autobuffer=!1,s.preload="auto"),s},i=function(){function t(e,t,r){return n._a?n._a.addEventListener(e,t,r||!1):null}if(n._a._added_events)return!1;var e;n._a._added_events=!0;for(e in It)It.hasOwnProperty(e)&&t(e,It[e]);return!0},a=function(){function t(e,t,r){return n._a?n._a.removeEventListener(e,t,r||!1):null}var e;n._a._added_events=!1;for(e in It)It.hasOwnProperty(e)&&t(e,It[e])},this._onload=function(e){var t,r=!!e||!n.isHTML5&&y===8&&n.duration;return n.loaded=r,n.readyState=r?3:2,n._onbufferchange(0),n._iO.onload&&Ut(n,function(){n._iO.onload.apply(n,[r])}),!0},this._onbufferchange=function(e){return n.playState===0?!1:e&&n.isBuffering||!e&&!n.isBuffering?!1:(n.isBuffering=e===1,n._iO.onbufferchange&&n._iO.onbufferchange.apply(n),!0)},this._onsuspend=function(){return n._iO.onsuspend&&n._iO.onsuspend.apply(n),!0},this._onfailure=function(e,t,r){n.failures++,n._iO.onfailure&&n.failures===1&&n._iO.onfailure(n,e,t,r)},this._onfinish=function(){var e=n._iO.onfinish;n._onbufferchange(0),n._resetOnPosition(0),n.instanceCount&&(n.instanceCount--,n.instanceCount||(v(),n.playState=0,n.paused=!1,n.instanceCount=0,n.instanceOptions={},n._iO={},f(),n.isHTML5&&(n.position=0)),(!n.instanceCount||n._iO.multiShotEvents)&&e&&Ut(n,function(){e.apply(n)}))},this._whileloading=function(e,t,r,i){var s=n._iO;n.bytesLoaded=e,n.bytesTotal=t,n.duration=Math.floor(r),n.bufferLength=i,!n.isHTML5&&!s.isMovieStar?s.duration?n.durationEstimate=n.duration>s.duration?n.duration:s.duration:n.durationEstimate=parseInt(n.bytesTotal/n.bytesLoaded*n.duration,10):n.durationEstimate=n.duration,n.isHTML5||(n.buffered=[{start:0,end:n.duration}]),(n.readyState!==3||n.isHTML5)&&s.whileloading&&s.whileloading.apply(n)},this._whileplaying=function(e,r,i,s,o){var u=n._iO,a;return isNaN(e)||e===null?!1:(n.position=Math.max(0,e),n._processOnPosition(),!n.isHTML5&&y>8&&(u.usePeakData&&r!==t&&r&&(n.peakData={left:r.leftPeak,right:r.rightPeak}),u.useWaveformData&&i!==t&&i&&(n.waveformData={left:i.split(","),right:s.split(",")}),u.useEQData&&o!==t&&o&&o.leftEQ&&(a=o.leftEQ.split(","),n.eqData=a,n.eqData.left=a,o.rightEQ!==t&&o.rightEQ&&(n.eqData.right=o.rightEQ.split(",")))),n.playState===1&&(!n.isHTML5&&y===8&&!n.position&&n.isBuffering&&n._onbufferchange(0),u.whileplaying&&u.whileplaying.apply(n)),!0)},this._oncaptiondata=function(e){n.captiondata=e,n._iO.oncaptiondata&&n._iO.oncaptiondata.apply(n,[e])},this._onmetadata=function(e,t){var r={},i,s;for(i=0,s=e.length;i<s;i++)r[e[i]]=t[i];n.metadata=r,n._iO.onmetadata&&n._iO.onmetadata.apply(n)},this._onid3=function(e,t){var r=[],i,s;for(i=0,s=e.length;i<s;i++)r[e[i]]=t[i];n.id3=O(n.id3,r),n._iO.onid3&&n._iO.onid3.apply(n)},this._onconnect=function(e){e=e===1,n.connected=e,e&&(n.failures=0,pt(n.id)&&(n.getAutoPlay()?n.play(t,n.getAutoPlay()):n._iO.autoLoad&&n.load()),n._iO.onconnect&&n._iO.onconnect.apply(n,[e]))},this._ondataerror=function(e){n.playState>0&&n._iO.ondataerror&&n._iO.ondataerror.apply(n)}},$=function(){return d.body||d.getElementsByTagName("div")[0]},c=function(e){return d.getElementById(e)},O=function(e,n){var r=e||{},i,o;i=n===t?s.defaultOptions:n;for(o in i)i.hasOwnProperty(o)&&r[o]===t&&(typeof i[o]!="object"||i[o]===null?r[o]=i[o]:r[o]=O(r[o],i[o]));return r},Ut=function(t,n){!t.isHTML5&&y===8?e.setTimeout(n,0):n()},_={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1,console:1},M=function(e,n){var r,i=!0,o=n!==t,u=s.setupOptions,a=_;for(r in e)e.hasOwnProperty(r)&&(typeof e[r]!="object"||e[r]===null||e[r]instanceof Array||e[r]instanceof RegExp?o&&a[n]!==t?s[n][r]=e[r]:u[r]!==t?(s.setupOptions[r]=e[r],s[r]=e[r]):a[r]===t?i=!1:s[r]instanceof Function?s[r].apply(s,e[r]instanceof Array?e[r]:[e[r]]):s[r]=e[r]:a[r]===t?i=!1:M(e[r],r));return i},_t=function(){function r(e){var n=Dt.call(e),r=n.length;return t?(n[1]="on"+n[1],r>3&&n.pop()):r===3&&n.push(!1),n}function i(e,r){var i=e.shift(),s=[n[r]];t?i[s](e[0],e[1]):i[s].apply(i,e)}function s(){i(r(arguments),"add")}function o(){i(r(arguments),"remove")}var t=e.attachEvent,n={add:t?"attachEvent":"addEventListener",remove:t?"detachEvent":"removeEventListener"};return{add:s,remove:o}}(),It={abort:pn(function(){}),canplay:pn(function(){var e=this._s,n;if(e._html5_canplay)return!0;e._html5_canplay=!0,e._onbufferchange(0),n=e._iO.position!==t&&!isNaN(e._iO.position)?e._iO.position/rn:null;if(e.position&&this.currentTime!==n)try{this.currentTime=n}catch(r){}e._iO._oncanplay&&e._iO._oncanplay()}),canplaythrough:pn(function(){var e=this._s;e.loaded||(e._onbufferchange(0),e._whileloading(e.bytesLoaded,e.bytesTotal,e._get_html5_duration()),e._onload(!0))}),ended:pn(function(){var e=this._s;e._onfinish()}),error:pn(function(){this._s._onload(!1)}),loadeddata:pn(function(){var e=this._s;!e._loaded&&!Jt&&(e.duration=e._get_html5_duration())}),loadedmetadata:pn(function(){}),loadstart:pn(function(){this._s._onbufferchange(1)}),play:pn(function(){this._s._onbufferchange(0)}),playing:pn(function(){this._s._onbufferchange(0)}),progress:pn(function(e){var t=this._s,n,r,i,s=0,o=e.type==="progress",u=e.target.buffered,a=e.loaded||0,f=e.total||1;t.buffered=[];if(u&&u.length){for(n=0,r=u.length;n<r;n++)t.buffered.push({start:u.start(n)*rn,end:u.end(n)*rn});s=(u.end(0)-u.start(0))*rn,a=Math.min(1,s/(e.target.duration*rn))}isNaN(a)||(t._onbufferchange(0),t._whileloading(a,f,t._get_html5_duration()),a&&f&&a===f&&It.canplaythrough.call(this,e))}),ratechange:pn(function(){}),suspend:pn(function(e){var t=this._s;It.progress.call(this,e),t._onsuspend()}),stalled:pn(function(){}),timeupdate:pn(function(){this._s._onTimer()}),waiting:pn(function(){var e=this._s;e._onbufferchange(1)})},Ct=function(e){var t;return!e||!e.type&&!e.url&&!e.serverURL?t=!1:e.serverURL||e.type&&hn(e.type)?t=!1:t=e.type?kt({type:e.type}):kt({url:e.url})||s.html5Only||e.url.match(/data\:/i),t},At=function(e){var t;return e&&(t=Jt?sn:s.html5.canPlayType("audio/wav")?on:sn,e.src=t,e._called_unload!==undefined&&(e._called_load=!1)),Pt&&(Ht=null),t},kt=function(e){if(!s.useHTML5Audio||!s.hasHTML5)return!1;var n=e.url||null,r=e.type||null,i=s.audioFormats,o,u,a,f;if(r&&s.html5[r]!==t)return s.html5[r]&&!hn(r);if(!Lt){Lt=[];for(f in i)i.hasOwnProperty(f)&&(Lt.push(f),i[f].related&&(Lt=Lt.concat(i[f].related)));Lt=new RegExp("\\.("+Lt.join("|")+")(\\?.*)?$","i")}return a=n?n.toLowerCase().match(Lt):null,!a||!a.length?r?(u=r.indexOf(";"),a=(u!==-1?r.substr(0,u):r).substr(6)):o=!1:a=a[1],a&&s.html5[a]!==t?o=s.html5[a]&&!hn(a):(r="audio/"+a,o=s.html5.canPlayType({type:r}),s.html5[a]=o,o=o&&s.html5[r]&&!hn(r)),o},Mt=function(){function a(t){var n,r,i=!1,o=!1;if(!e||typeof e.canPlayType!="function")return i;if(t instanceof Array){for(u=0,r=t.length;u<r;u++)if(s.html5[t[u]]||e.canPlayType(t[u]).match(s.html5Test))o=!0,s.html5[t[u]]=!0,s.flash[t[u]]=!!t[u].match(nn);i=o}else n=e&&typeof e.canPlayType=="function"?e.canPlayType(t):!1,i=!!n&&!!n.match(s.html5Test);return i}if(!s.useHTML5Audio||!s.hasHTML5)return s.html5.usingFlash=!0,Tt=!0,!1;var e=Audio!==t?Kt&&opera.version()<10?new Audio(null):new Audio:null,n,r,i={},o,u;o=s.audioFormats;for(n in o)if(o.hasOwnProperty(n)){r="audio/"+n,i[n]=a(o[n].type),i[r]=i[n],n.match(nn)?(s.flash[n]=!0,s.flash[r]=!0):(s.flash[n]=!1,s.flash[r]=!1);if(o[n]&&o[n].related)for(u=o[n].related.length-1;u>=0;u--)i["audio/"+o[n].related[u]]=i[n],s.html5[o[n].related[u]]=i[n],s.flash[o[n].related[u]]=i[n]}return i.canPlayType=e?a:null,s.html5=O(s.html5,i),s.html5.usingFlash=Nt(),Tt=s.html5.usingFlash,!0},R={},st=function(){},lt=function(e){return y===8&&e.loops>1&&e.stream&&(e.stream=!1),e},ct=function(e,t){return e&&!e.usePolicyFile&&(e.onid3||e.usePeakData||e.useWaveformData||e.useEQData)&&(e.usePolicyFile=!0),e},ht=function(e){},v=function(){return!1},et=function(e){var t;for(t in e)e.hasOwnProperty(t)&&typeof e[t]=="function"&&(e[t]=v);t=null},tt=function(e){e===t&&(e=!1),(N||e)&&s.disable(e)},nt=function(e){var t=null,n;if(e)if(e.match(/\.swf(\?.*)?$/i)){t=e.substr(e.toLowerCase().lastIndexOf(".swf?")+4);if(t)return e}else e.lastIndexOf("/")!==e.length-1&&(e+="/");return n=(e&&e.lastIndexOf("/")!==-1?e.substr(0,e.lastIndexOf("/")+1):"./")+s.movieURL,s.noSWFCache&&(n+="?ts="+(new Date).getTime()),n},I=function(){y=parseInt(s.flashVersion,10),y!==8&&y!==9&&(s.flashVersion=y=Z);var e=s.debugMode||s.debugFlash?"_debug.swf":".swf";s.useHTML5Audio&&!s.html5Only&&s.audioFormats.mp4.required&&y<9&&(s.flashVersion=y=9),s.version=s.versionNumber+(s.html5Only?" (HTML5-only mode)":y===9?" (AS3/Flash 9)":" (AS2/Flash 8)"),y>8?(s.defaultOptions=O(s.defaultOptions,s.flash9Options),s.features.buffering=!0,s.defaultOptions=O(s.defaultOptions,s.movieStarOptions),s.filePatterns.flash9=new RegExp("\\.(mp3|"+ln.join("|")+")(\\?.*)?$","i"),s.features.movieStar=!0):s.features.movieStar=!1,s.filePattern=s.filePatterns[y!==8?"flash9":"flash8"],s.movieURL=(y===8?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",e),s.features.peakData=s.features.waveformData=s.features.eqData=y>8},Q=function(e,t){if(!u)return!1;u._setPolling(e,t)},G=function(){},pt=this.getSoundById,ut=function(){var e=[];return s.debugMode&&e.push(at.sm2Debug),s.debugFlash&&e.push(at.flashDebug),s.useHighPerformance&&e.push(at.highPerf),e.join(" ")},ot=function(){var e=st("fbHandler"),t=s.getMoviePercent(),n=at,r={type:"FLASHBLOCK"};if(s.html5Only)return!1;s.ok()?s.oMC&&(s.oMC.className=[ut(),n.swfDefault,n.swfLoaded+(s.didFlashBlock?" "+n.swfUnblocked:"")].join(" ")):(Tt&&(s.oMC.className=ut()+" "+n.swfDefault+" "+(t===null?n.swfTimedout:n.swfError)),s.didFlashBlock=!0,P({type:"ontimeout",ignoreInit:!0,error:r}),K(r))},D=function(e,n,r){b[e]===t&&(b[e]=[]),b[e].push({method:n,scope:r||null,fired:!1})},P=function(e){e||(e={type:s.ok()?"onready":"ontimeout"});if(!T&&e&&!e.ignoreInit)return!1;if(e.type==="ontimeout"&&(s.ok()||N&&!e.ignoreInit))return!1;var t={success:e&&e.ignoreInit?s.ok():!N},n=e&&e.type?b[e.type]||[]:[],r=[],i,o,u=[t],a=Tt&&!s.ok();e.error&&(u[0].error=e.error);for(i=0,o=n.length;i<o;i++)n[i].fired!==!0&&r.push(n[i]);if(r.length)for(i=0,o=r.length;i<o;i++)r[i].scope?r[i].method.apply(r[i].scope,u):r[i].method.apply(this,u),a||(r[i].fired=!0);return!0},H=function(){e.setTimeout(function(){s.useFlashBlock&&ot(),P(),typeof s.onload=="function"&&s.onload.apply(e),s.waitForWindowLoad&&_t.add(e,"load",H)},1)},jt=function(){if(Bt!==t)return Bt;var n=!1,r=navigator,i=r.plugins,s,o,u,a=e.ActiveXObject;if(i&&i.length)o="application/x-shockwave-flash",u=r.mimeTypes,u&&u[o]&&u[o].enabledPlugin&&u[o].enabledPlugin.description&&(n=!0);else if(a!==t&&!h.match(/MSAppHost/i)){try{s=new a("ShockwaveFlash.ShockwaveFlash")}catch(f){s=null}n=!!s,s=null}return Bt=n,n},Nt=function(){var e,t,n=s.audioFormats,r=Wt&&!!h.match(/os (1|2|3_0|3_1)/i);r?(s.hasHTML5=!1,s.html5Only=!0,s.oMC&&(s.oMC.style.display="none")):s.useHTML5Audio&&(!s.html5||!s.html5.canPlayType)&&(s.hasHTML5=!1);if(s.useHTML5Audio&&s.hasHTML5){xt=!0;for(t in n)n.hasOwnProperty(t)&&n[t].required&&(s.html5.canPlayType(n[t].type)?s.preferFlash&&(s.flash[t]||s.flash[n[t].type])&&(e=!0):(xt=!1,e=!0))}return s.ignoreFlash&&(e=!1,xt=!0),s.html5Only=s.hasHTML5&&s.useHTML5Audio&&!e,!s.html5Only},Et=function(e){var t,n,r=0,i;if(e instanceof Array){for(t=0,n=e.length;t<n;t++)if(e[t]instanceof Object){if(s.canPlayMIME(e[t].type)){r=t;break}}else if(s.canPlayURL(e[t])){r=t;break}e[r].url&&(e[r]=e[r].url),i=e[r]}else i=e;return i},mt=function(e){e._hasTimer||(e._hasTimer=!0,!Qt&&s.html5PollingInterval&&(wt===null&&bt===0&&(wt=setInterval(yt,s.html5PollingInterval)),bt++))},gt=function(e){e._hasTimer&&(e._hasTimer=!1,!Qt&&s.html5PollingInterval&&bt--)},yt=function(){var e;if(wt!==null&&!bt)return clearInterval(wt),wt=null,!1;for(e=s.soundIDs.length-1;e>=0;e--)s.sounds[s.soundIDs[e]].isHTML5&&s.sounds[s.soundIDs[e]]._hasTimer&&s.sounds[s.soundIDs[e]]._onTimer()},K=function(n){n=n!==t?n:{},typeof s.onerror=="function"&&s.onerror.apply(e,[{type:n.type!==t?n.type:null}]),n.fatal!==t&&n.fatal&&s.disable()},Ft=function(){if(!Gt||!jt())return!1;var e=s.audioFormats,t,n;for(n in e)if(e.hasOwnProperty(n))if(n==="mp3"||n==="mp4"){s.html5[n]=!1;if(e[n]&&e[n].related)for(t=e[n].related.length-1;t>=0;t--)s.html5[e[n].related[t]]=!1}},this._setSandboxType=function(e){},this._externalInterfaceOK=function(e){if(s.swfLoaded)return!1;var t;s.swfLoaded=!0,en=!1,Gt&&Ft(),setTimeout(g,Vt?100:1)},J=function(e,n){function r(){}function C(e,t){return'<param name="'+e+'" value="'+t+'" />'}if(S&&x)return!1;if(s.html5Only)return I(),r(),s.oMC=c(s.movieID),g(),S=!0,x=!0,!1;var i=n||s.url,o=s.altURL||i,u="JS/Flash audio component (SoundManager 2)",a=$(),f=ut(),l=null,p=d.getElementsByTagName("html")[0],v,m,y,b,w,E,T,N;l=p&&p.dir&&p.dir.match(/rtl/i),e=e===t?s.id:e,I(),s.url=nt(un?i:o),n=s.url,s.wmode=!s.wmode&&s.useHighPerformance?"transparent":s.wmode,s.wmode!==null&&(h.match(/msie 8/i)||!Vt&&!s.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(St.push(R.spcWmode),s.wmode=null),v={name:e,id:e,src:n,quality:"high",allowScriptAccess:s.allowScriptAccess,bgcolor:s.bgColor,pluginspage:an+"www.macromedia.com/go/getflashplayer",title:u,type:"application/x-shockwave-flash",wmode:s.wmode,hasPriority:"true"},s.debugFlash&&(v.FlashVars="debug=1"),s.wmode||delete v.wmode;if(Vt)m=d.createElement("div"),b=['<object id="'+e+'" data="'+n+'" type="'+v.type+'" title="'+v.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+an+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',C("movie",n),C("AllowScriptAccess",s.allowScriptAccess),C("quality",v.quality),s.wmode?C("wmode",s.wmode):"",C("bgcolor",s.bgColor),C("hasPriority","true"),s.debugFlash?C("FlashVars",v.FlashVars):"","</object>"].join("");else{m=d.createElement("embed");for(y in v)v.hasOwnProperty(y)&&m.setAttribute(y,v[y])}G(),f=ut(),a=$();if(a){s.oMC=c(s.movieID)||d.createElement("div");if(!s.oMC.id){s.oMC.id=s.movieID,s.oMC.className=at.swfDefault+" "+f,E=null,w=null,s.useFlashBlock||(s.useHighPerformance?E={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(E={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},l&&(E.left=Math.abs(parseInt(E.left,10))+"px"))),$t&&(s.oMC.style.zIndex=1e4);if(!s.debugFlash)for(T in E)E.hasOwnProperty(T)&&(s.oMC.style[T]=E[T]);try{Vt||s.oMC.appendChild(m),a.appendChild(s.oMC),Vt&&(w=s.oMC.appendChild(d.createElement("div")),w.className=at.swfBox,w.innerHTML=b),x=!0}catch(k){throw new Error(st("domError")+" \n"+k.toString())}}else N=s.oMC.className,s.oMC.className=(N?N+" ":at.swfDefault)+(f?" "+f:""),s.oMC.appendChild(m),Vt&&(w=s.oMC.appendChild(d.createElement("div")),w.className=at.swfBox,w.innerHTML=b),x=!0}return S=!0,r(),!0},U=function(){return s.html5Only?(J(),!1):u?!1:s.url?(u=s.getMovie(s.id),u||(rt?(Vt?s.oMC.innerHTML=it:s.oMC.appendChild(rt),rt=null,S=!0):J(s.id,s.url),u=s.getMovie(s.id)),typeof s.oninitmovie=="function"&&setTimeout(s.oninitmovie,1),!0):!1},B=function(){setTimeout(j,1e3)},F=function(){e.setTimeout(function(){s.setup({preferFlash:!1}).reboot(),s.didFlashBlock=!0,s.beginDelayedInit()},1)},j=function(){var t,n=!1;if(!s.url)return!1;if(dt)return!1;dt=!0,_t.remove(e,"load",B);if(Bt&&en&&!Zt)return!1;T||(t=s.getMoviePercent(),t>0&&t<100&&(n=!0)),setTimeout(function(){t=s.getMoviePercent();if(n)return dt=!1,e.setTimeout(B,1),!1;!T&&tn&&(t===null?s.useFlashBlock||s.flashLoadTimeout===0?s.useFlashBlock&&ot():!s.useFlashBlock&&xt?F():P({type:"ontimeout",ignoreInit:!0,error:{type:"INIT_FLASHBLOCK"}}):s.flashLoadTimeout!==0&&(!s.useFlashBlock&&xt?F():tt(!0)))},s.flashLoadTimeout)},q=function(){function t(){_t.remove(e,"focus",q)}return Zt||!en?(t(),!0):(tn=!0,Zt=!0,dt=!1,B(),t(),!0)},Rt=function(){},qt=function(){},A=function(t){if(T)return!1;if(s.html5Only)return T=!0,H(),!0;var n=s.useFlashBlock&&s.flashLoadTimeout&&!s.getMoviePercent(),r=!0,i;n||(T=!0),i={type:!Bt&&Tt?"NO_FLASH":"INIT_TIMEOUT"};if(N||t)s.useFlashBlock&&s.oMC&&(s.oMC.className=ut()+" "+(s.getMoviePercent()===null?at.swfTimedout:at.swfError)),P({type:"ontimeout",error:i,ignoreInit:!0}),K(i),r=!1;return N||(s.waitForWindowLoad&&!C?_t.add(e,"load",H):H()),r},m=function(){var e,n=s.setupOptions;for(e in n)n.hasOwnProperty(e)&&(s[e]===t?s[e]=n[e]:s[e]!==n[e]&&(s.setupOptions[e]=s[e]))},g=function(){function t(){_t.remove(e,"load",s.beginDelayedInit)}if(T)return!1;if(s.html5Only)return T||(t(),s.enabled=!0,A()),!0;U();try{u._externalInterfaceTest(!1),Q(!0,s.flashPollingInterval||(s.useHighPerformance?10:50)),s.debugMode||u._disableDebug(),s.enabled=!0,s.html5Only||_t.add(e,"unload",v)}catch(n){return K({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),tt(!0),A(),!1}return A(),t(),!0},W=function(){return V?!1:(V=!0,m(),G(),!Bt&&s.hasHTML5&&s.setup({useHTML5Audio:!0,preferFlash:!1}),Mt(),!Bt&&Tt&&(St.push(R.needFlash),s.setup({flashLoadTimeout:1})),d.removeEventListener&&d.removeEventListener("DOMContentLoaded",W,!1),U(),!0)},Ot=function(){return d.readyState==="complete"&&(W(),d.detachEvent("onreadystatechange",Ot)),!0},X=function(){C=!0,W(),_t.remove(e,"load",X)},z=function(){if(Qt){s.setupOptions.useHTML5Audio=!0,s.setupOptions.preferFlash=!1;if(Wt||Xt&&!h.match(/android\s2\.3/i))Wt&&(s.ignoreFlash=!0),Pt=!0}},z(),jt(),_t.add(e,"focus",q),_t.add(e,"load",B),_t.add(e,"load",X),d.addEventListener?d.addEventListener("DOMContentLoaded",W,!1):d.attachEvent?d.attachEvent("onreadystatechange",Ot):K({type:"NO_DOM2_EVENTS",fatal:!0})}var n=null;if(e.SM2_DEFER===undefined||!SM2_DEFER)n=new r;e.SoundManager=r,e.soundManager=n}(window),define("Soundmanager",function(e){return function(){var t,n;return t||e.SoundManager}}(this)),define("feed/speaker",["underscore","jquery","feed/log","feed/events","feed/util","Soundmanager"],function(e,t,n,r,i,s){var o={log:n,info:n,warn:n,error:n},u=function(t){var n=e.extend(this,r);return t&&("startPosition"in t&&(this.startPosition=t.startPosition),e.each(["play","pause","finish","elapse"],function(e){e in t&&n.on(e,t[e])})),n};u.prototype={play:function(){var e=this;if(this.sm2Sound)if(!this.sm2Sound.fake&&this.startPosition){var t=this.startPosition;this.sm2Sound.load({whileloading:function(){this.playState===0&&this.duration>t&&(this.setPosition(t),this.play())}})}else this.sm2Sound.isHTML5?this.sm2Sound.play():setTimeout(function(){e.sm2Sound.play()},1)},pause:function(){this.sm2Sound&&this.sm2Sound.pause()},resume:function(){this.sm2Sound&&this.sm2Sound.resume()},position:function(){return this.sm2Sound?this.sm2Sound.position:0},duration:function(){if(this.sm2Sound){var e=this.sm2Sound.duration;return e?e:1}return 1},destroy:function(){n("destroy triggered for",this.id),this.sm2Sound&&(delete f.outstandingPlays[this.id],this.sm2Sound.destruct(),this.sm2Sound=null),this.off()},_nonRepeatTrigger:function(e){this.lastTrigger!==e&&(this.lastTrigger=e,this.trigger.apply(this,Array.prototype.slice.call(arguments,0)))}};var a=function(e){var n=this;e=e||{},this.onReadyPromise=t.Deferred();var r={wmode:"transparent",useHighPerformance:!0,flashPollingInterval:500,html5PollingInterval:500,debugMode:e.debug||!1,console:e.debug?o:null,debugFlash:e.debug||!1,preferFlash:e.preferFlash||!1,url:i.addProtocol("swfBase"in e?e.swfBase:"//feed.fm/js/latest/",e.secure),onready:function(){var e;window.soundManager.canPlayMIME("audio/aac")?e="aac,mp3":e="mp3",n.onReadyPromise.resolve(e)}};window.soundManager||(window.soundManager=new s),window.soundManager.setup(r),this.silence=i.addProtocol(e.silence||"//feed.fm/js/latest/5seconds.mp3",e.secure)};a.prototype={vol:100,outstandingPlays:{},mobileInitialized:!1,onReadyPromise:null,initializeForMobile:function(){if(!this.mobileInitialized){var e=this._createSM2Sound({id:"silence",url:this.silence,volume:0,autoPlay:!0,type:"audio/mp3"});this.mobileInitialized=!e.fake}},create:function(t,n){var r=new u(n);return r.id=e.uniqueId("play"),r.url=t,this.outstandingPlays[r.id]=r,this._createAndAssignSM2Sound(r),r},_createSM2Sound:function(e){return window.soundManager.createSound(e)},_createAndAssignSM2Sound:function(e){var t=this;return e.sm2Sound=this._createSM2Sound({id:e.id,url:e.url,volume:t.vol,autoPlay:!1,type:"audio/mp3",onfinish:function(){n(e.id+": onfinish"),this.destruct(),delete t.outstandingPlays[e.id],e._nonRepeatTrigger("finish")},onid3:function(){n(e.id+": onid3")},onstop:function(){n(e.id+": onstop")},onsuspend:function(){n(e.id+": suspend")},onresume:function(){n(e.id+": onresume"),e._nonRepeatTrigger("play")},onplay:function(){n(e.id+": onplay"),e._nonRepeatTrigger("play")},onpause:function(){n(e.id+": pause"),e._nonRepeatTrigger("pause")},onload:function(t){n(e.id+": onload",t),t||(n(e.id+" failure!"),e._nonRepeatTrigger("finish"),n("destroying after onload failure"),e.destroy())},ondataerror:function(){n(e.id+": ondataerror"),e._nonRepeatTrigger("finish"),n("destroying after ondataerr"),e.destroy()},onconnect:function(){n(e.id+": onconnect")},onbufferchange:function(){n(e.id+": onbufferchange")},whileplaying:function(){e.trigger("elapse")}}),e},setVolume:function(t){return typeof t!="undefined"&&(this.vol=t,e.each(this.outstandingPlays,function(e){e.sm2Sound.setVolume(t)}),this.trigger("volume",t)),this.vol}},e.extend(a.prototype,r);var f=null;return function(e,t){return f===null&&(f=new a(e)),t&&f.onReadyPromise.then(function(e){t(e)}),f}}),define("feed/player",["underscore","jquery","feed/log","feed/speaker","feed/events","feed/session"],function(e,t,n,r,i,s){function o(){try{return"localStorage"in window&&window.localStorage!==null}catch(e){return!1}}var u=function(n,o,u){this.state={paused:!0,suspended:!1},u=u||{},this.skipPlayDelay=!!u.skipPlayDelay,e.extend(this,i);var a=this.session=new s(n,o,u);this.session.on("play-active",this._onPlayActive,this),this.session.on("play-started",this._onPlayStarted,this),this.session.on("play-completed",this._onPlayCompleted,this),this.session.on("plays-exhausted",this._onPlaysExhausted,this),this.session.on("all",function(){this.trigger.apply(this,Array.prototype.slice.call(arguments,0))},this);var f=this.initializeSpeaker=t.Deferred();this.speaker=r(u,function(t){if(u.formats){var n=u.formats.split(","),r=t.split(","),i=e.intersection(n,r),s=i.join(",");i.length===0&&(s=t),a.setFormats(s)}else a.setFormats(t);f.resolve()}),this.setMuted(this.isMuted())};u.prototype.setPlacementId=function(e){this.session.setPlacementId(e)},u.prototype.setStationId=function(e){this.session.setStationId(e)},u.prototype.setBaseUrl=function(e){this.session.setBaseUrl(e)},u.prototype._onPlayActive=function(t){var n={play:e.bind(this._onSoundPlay,this,t.id),pause:e.bind(this._onSoundPause,this,t.id),finish:e.bind(this._onSoundFinish,this,t.id),elapse:e.bind(this._onSoundElapse,this,t.id)};t.startPosition&&(n.startPosition=t.startPosition);var r=this.speaker.create(t.audio_file.url,n);this.state.activePlay={id:t.id,sound:r,startReportedToServer:!1,soundCompleted:!1,playStarted:!1,previousPosition:0};if(!this.state.paused){var i=this.state.activePlay.sound;i.play()}},u.prototype._onSoundPlay=function(e){if(!this.state.activePlay||this.state.activePlay.id!==e){n("received sound play, but active play does not match",this.state.activePlay,e);return}this.state.paused=!1,this.state.activePlay.playStarted=!0;if(!this.state.activePlay.startReportedToServer)return this.session.reportPlayStarted();this.trigger("play-resumed",this.session.getActivePlay())},u.prototype.getActivePlay=function(){return this.session.getActivePlay()},u.prototype.hasActivePlayStarted=function(){return this.session.hasActivePlayStarted()},u.prototype.getActivePlacement=function(){return this.session.getActivePlacement()},u.prototype._onSoundPause=function(e){if(!this.state.activePlay||this.state.activePlay.id!==e){n("received sound pause, but active play does not match",this.state.activePlay,e);return}this.state.paused=!0,this.trigger("play-paused",this.session.getActivePlay())},u.prototype._onSoundFinish=function(e){if(!this.state.activePlay||this.state.activePlay.id!==e){n("received sound finish, but active play does not match",this.state.activePlay,e);return}this.state.activePlay.soundCompleted=!0;if(!this.state.activePlay.playStarted){this.session.requestInvalidate();return}if(!this.state.activePlay.startReportedToServer)return;this.session.reportPlayCompleted()},u.prototype._onSoundElapse=function(e){if(!this.state.activePlay||this.state.activePlay.id!==e){n("received sound elapse, but active play does not match",this.state.activePlay,e);return}var t=this.state.activePlay.sound,r=t.position(),i=3e4,s=Math.floor(this.state.activePlay.previousPosition/i),o=Math.floor(r/i);this.state.activePlay.previousPosition=r,o!==s&&this.session.reportPlayElapsed(Math.floor(r/1e3))},u.prototype._onPlayStarted=function(t){var r=this.session;if(!this.state.activePlay||this.state.activePlay.id!==t.id){n("received play started, but it does not match active play",t,this.state.activePlay);return}this.state.activePlay.startReportedToServer=!0,this.state.activePlay.soundCompleted&&(n("sound completed before we finished reporting start",this.state.activePlay),e.defer(function(){r.reportPlayCompleted()}))},u.prototype._onPlayCompleted=function(e){if(!this.state.activePlay||this.state.activePlay.id!==e.id){n("received play completed, but it does not match active play",e,this.state.activePlay);return}this.state.activePlay.sound.destroy(),delete this.state.activePlay,this.state.paused=!1},u.prototype._onPlaysExhausted=function(){this.state.paused=!1},u.prototype.isPaused=function(){return this.session.isTuned()&&this.state.paused},u.prototype.getStationInformation=function(e){return this.session.getStationInformation(e)},u.prototype.tune=function(){var e=this;this.initializeSpeaker.then(function(){e.session.isTuned()||e.session.tune()})},u.prototype.play=function(){var e=this;this.initializeSpeaker.then(function(){e.speaker.initializeForMobile();if(!e.session.isTuned())return e.state.paused=!1,e.session.tune();e.session.getActivePlay()&&e.state.activePlay&&e.state.paused&&(e.state.activePlay.playStarted?e.state.activePlay.sound.resume():e.state.activePlay.sound.play())})},u.prototype.pause=function(){if(!this.session.hasActivePlayStarted()||!this.state.activePlay||this.state.paused)return;this.state.activePlay.sound.pause()},u.prototype.like=function(){if(!this.session.hasActivePlayStarted())return;this.session.likePlay(this.state.activePlay.id),this.trigger("play-liked")},u.prototype.unlike=function(){if(!this.session.hasActivePlayStarted())return;this.session.unlikePlay(this.state.activePlay.id),this.trigger("play-unliked")},u.prototype.dislike=function(){if(!this.session.hasActivePlayStarted())return;this.session.dislikePlay(this.state.activePlay.id),this.trigger("play-disliked"),this.skip()},u.prototype.skip=function(){if(!this.session.hasActivePlayStarted())return;this.session.requestSkip()},u.prototype.destroy=function(){this.session=null,this.state.activePlay&&this.state.activePlay.sound&&this.state.activePlay.sound.destroy()},u.prototype.getCurrentState=function(){return this.state.suspended?"suspended":this.session.hasActivePlayStarted()?this.state.paused?"paused":"playing":"idle"},u.prototype.getPosition=function(){return this.state.activePlay&&this.state.activePlay.sound?this.state.activePlay.sound.position():0},u.prototype.getDuration=function(){return this.state.activePlay&&this.state.activePlay.sound?this.state.activePlay.sound.duration():0},u.prototype.maybeCanSkip=function(){return this.session.maybeCanSkip()};var a="muted";return u.prototype.isMuted=function(){return o()&&a in localStorage?localStorage[a]==="true":!1},u.prototype.setMuted=function(e){e?(this.speaker.setVolume(0),o()&&(localStorage[a]=!0),this.trigger("muted")):(this.speaker.setVolume(100),o()&&(localStorage[a]=!1),this.trigger("unmuted"))},u.prototype.suspend=function(){var e=this.state.activePlay&&this.state.activePlay.sound,t=this.session.suspend(e?this.state.activePlay.sound.position():0);return this.pause(),this.state.suspended=!0,this.trigger("suspend"),t},u.prototype.unsuspend=function(e,t){this.session.unsuspend(e),t&&this.play()},u}),define("feed/feed",["feed/session","feed/log","feed/player-view","feed/player","feed/speaker"],function(e,t,n,r,i){return{Session:e,Player:r,PlayerView:n,log:t,getSpeaker:i}}),require.config({map:{"*":{jquery:"feed/jquery-external","feed/log":"feed/nolog"}}}),window.Feed=require("feed/feed");